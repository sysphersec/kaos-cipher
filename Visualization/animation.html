<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAOS Cipher: Lorenz Attractor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: #0f0f23;
            color: #00ff00;
            overflow: hidden;
        }
        
        #container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        #canvas-container {
            width: 100%;
            height: 100%;
        }
        
        #controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00ff00;
            z-index: 100;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input[type="range"] {
            width: 200px;
        }
        
        button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 8px 16px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        button:hover {
            background: #00cc00;
        }
        
        #info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00ff00;
            max-width: 300px;
        }
        
        .phase-warmup { color: #ff4444; }
        .phase-encryption { color: #44ff44; }
        
        .keystream-byte {
            display: inline-block;
            width: 30px;
            text-align: center;
            background: #003300;
            margin: 2px;
            padding: 2px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="canvas-container"></div>
        
        <div id="controls">
            <h2>ğŸ® KAOS Cipher Controls</h2>
            
            <div class="control-group">
                <label for="speed">Animation Speed: <span id="speed-value">1x</span></label>
                <input type="range" id="speed" min="0.1" max="5" value="1" step="0.1">
            </div>
            
            <div class="control-group">
                <label for="trail">Trail Length: <span id="trail-value">500</span></label>
                <input type="range" id="trail" min="100" max="1500" value="500" step="50">
            </div>
            
            <div class="control-group">
                <button id="play-pause">â¸ï¸ Pause</button>
                <button id="restart">ğŸ”„ Restart</button>
                <button id="loop">ğŸ” Loop: OFF</button>
            </div>
            
            <div class="control-group">
                <label>Camera Presets:</label>
                <button data-preset="top">Top View</button>
                <button data-preset="side">Side View</button>
                <button data-preset="orbit">Orbit Mode</button>
            </div>
        </div>
        
        <div id="info-panel">
            <h3>ğŸ“Š Chaos Information</h3>
            <div id="step-info">Step: <span>0</span></div>
            <div id="phase-info">Phase: <span class="phase-warmup">WARMUP</span></div>
            <div id="position-info">
                Position: <br>
                X: <span id="pos-x">0.000</span><br>
                Y: <span id="pos-y">0.000</span><br>
                Z: <span id="pos-z">0.000</span>
            </div>
            <div id="keystream-info">
                Keystream Byte: <span class="keystream-byte">0</span>
            </div>
            <div id="stats">
                Points: <span id="points-current">0</span>/<span id="points-total">1029</span><br>
                FPS: <span>0</span>
            </div>
        </div>
    </div>

    <script>
        // ===== DATOS REALES CORREGIDOS =====
        const chaosData = {
            metadata: {
                totalPoints: 1029,
                plaintext: "KAOS CIPHER SECURE ENCRYPTION",
                textLength: 29,
                warmupIterations: 1000
            },
            trajectory: [
                {x: 0.524327, y: 0.550790, z: 0.024784, step: 0, phase: "warmup", keystream: 0},
                {x: 0.526973, y: 0.691964, z: 0.027011, step: 1, phase: "warmup", keystream: 0},
                {x: 0.543473, y: 0.832455, z: 0.029937, step: 2, phase: "warmup", keystream: 0},
                {x: 0.572371, y: 0.976140, z: 0.033663, step: 3, phase: "warmup", keystream: 0},
                {x: 0.612748, y: 1.126449, z: 0.038352, step: 4, phase: "warmup", keystream: 0},
                {x: 0.664118, y: 1.286519, z: 0.044232, step: 5, phase: "warmup", keystream: 0},
                {x: 0.726358, y: 1.459313, z: 0.051596, step: 6, phase: "warmup", keystream: 0},
                {x: 0.799653, y: 1.647726, z: 0.060820, step: 7, phase: "warmup", keystream: 0},
                {x: 0.884461, y: 1.854665, z: 0.072375, step: 8, phase: "warmup", keystream: 0},
                {x: 0.981481, y: 2.083127, z: 0.086848, step: 9, phase: "warmup", keystream: 0},
                {x: 1.091646, y: 2.336258, z: 0.104978, step: 10, phase: "warmup", keystream: 0},
                {x: 1.216107, y: 2.617410, z: 0.127682, step: 11, phase: "warmup", keystream: 0},
                {x: 1.356237, y: 2.930194, z: 0.156108, step: 12, phase: "warmup", keystream: 0},
                {x: 1.513633, y: 3.278521, z: 0.191685, step: 13, phase: "warmup", keystream: 0},
                {x: 1.690122, y: 3.666652, z: 0.236199, step: 14, phase: "warmup", keystream: 0},
                {x: 1.887775, y: 4.099227, z: 0.291871, step: 15, phase: "warmup", keystream: 0},
                {x: 2.108920, y: 4.581302, z: 0.361472, step: 16, phase: "warmup", keystream: 0},
                {x: 2.356158, y: 5.118363, z: 0.448448, step: 17, phase: "warmup", keystream: 0},
                {x: 2.632379, y: 5.716338, z: 0.557087, step: 18, phase: "warmup", keystream: 0},
                {x: 2.940775, y: 6.381576, z: 0.692707, step: 19, phase: "warmup", keystream: 0},
                {x: 3.284855, y: 7.120806, z: 0.861902, step: 20, phase: "warmup", keystream: 0},
                {x: 3.668450, y: 7.941045, z: 1.072826, step: 21, phase: "warmup", keystream: 0},
                {x: 4.095709, y: 8.849444, z: 1.335531, step: 22, phase: "warmup", keystream: 0},
                {x: 4.571083, y: 9.853049, z: 1.662364, step: 23, phase: "warmup", keystream: 0},
                {x: 5.099279, y: 10.958434, z: 2.068425, step: 24, phase: "warmup", keystream: 0},
                {x: 5.685195, y: 12.171173, z: 2.572069, step: 25, phase: "warmup", keystream: 0},
                {x: 6.333793, y: 13.495089, z: 3.195435, step: 26, phase: "warmup", keystream: 0},
                {x: 7.049922, y: 14.931208, z: 3.964974, step: 27, phase: "warmup", keystream: 0},
                {x: 7.838051, y: 16.476346, z: 4.911880, step: 28, phase: "warmup", keystream: 0},
                {x: 8.701880, y: 18.121241, z: 6.072321, step: 29, phase: "warmup", keystream: 0},
                {x: 9.643816, y: 19.848149, z: 7.487281, step: 30, phase: "warmup", keystream: 0},
                {x: 10.664250, y: 21.627877, z: 9.201740, step: 31, phase: "warmup", keystream: 0},
                {x: 11.760612, y: 23.416291, z: 11.262811, step: 32, phase: "warmup", keystream: 0},
                {x: 12.926180, y: 25.150524, z: 13.716368, step: 33, phase: "warmup", keystream: 0},
                {x: 14.148615, y: 26.745347, z: 16.601601, step: 34, phase: "warmup", keystream: 0},
                {x: 15.408288, y: 28.090609, z: 19.942987, step: 35, phase: "warmup", keystream: 0},
                {x: 16.676520, y: 29.051151, z: 23.739456, step: 36, phase: "warmup", keystream: 0},
                {x: 17.913983, y: 29.471150, z: 27.951125, step: 37, phase: "warmup", keystream: 0},
                {x: 19.069700, y: 29.185194, z: 32.485219, step: 38, phase: "warmup", keystream: 0},
                {x: 20.081249, y: 28.038024, z: 37.184475, step: 39, phase: "warmup", keystream: 0},
                {x: 20.876927, y: 25.913287, z: 41.823274, step: 40, phase: "warmup", keystream: 0},
                {x: 21.380563, y: 22.768279, z: 46.117885, step: 41, phase: "warmup", keystream: 0},
                {x: 21.519334, y: 18.666890, z: 49.756061, step: 42, phase: "warmup", keystream: 0},
                {x: 21.234090, y: 13.798462, z: 52.446223, step: 43, phase: "warmup", keystream: 0},
                {x: 20.490527, y: 8.469544, z: 53.977635, step: 44, phase: "warmup", keystream: 0},
                {x: 19.288429, y: 3.061895, z: 54.273685, step: 45, phase: "warmup", keystream: 0},
                {x: 17.665775, y: -2.036505, z: 53.416979, step: 46, phase: "warmup", keystream: 0},
                {x: 15.695547, y: -6.506247, z: 51.632761, step: 47, phase: "warmup", keystream: 0},
                {x: 13.475368, y: -10.150475, z: 49.234697, step: 48, phase: "warmup", keystream: 0},
                {x: 11.112784, y: -12.910424, z: 46.553958, step: 49, phase: "warmup", keystream: 0},
                {x: 8.710463, y: -14.843181, z: 43.877811, step: 50, phase: "warmup", keystream: 0},
                {x: 6.355098, y: -16.077780, z: 41.414826, step: 51, phase: "warmup", keystream: 0},
                {x: 4.111811, y: -16.769528, z: 39.288672, step: 52, phase: "warmup", keystream: 0},
                {x: 2.023677, y: -17.066001, z: 37.551443, step: 53, phase: "warmup", keystream: 0},
                {x: 0.114709, y: -17.088632, z: 36.204711, step: 54, phase: "warmup", keystream: 0},
                {x: -1.605625, y: -16.927157, z: 35.219650, step: 55, phase: "warmup", keystream: 0},
                {x: -3.137778, y: -16.641965, z: 34.552246, step: 56, phase: "warmup", keystream: 0},
                {x: -4.488197, y: -16.269950, z: 34.153040, step: 57, phase: "warmup", keystream: 0},
                {x: -5.666372, y: -15.831090, z: 33.972520, step: 58, phase: "warmup", keystream: 0},
                {x: -6.682844, y: -15.334354, z: 33.963635, step: 59, phase: "warmup", keystream: 0},
                {x: -7.547995, y: -14.782470, z: 34.082709, step: 60, phase: "warmup", keystream: 0},
                {x: -8.271443, y: -14.175523, z: 34.289617, step: 61, phase: "warmup", keystream: 0},
                {x: -8.861851, y: -13.513526, z: 34.547747, step: 62, phase: "warmup", keystream: 0},
                {x: -9.327018, y: -12.798139, z: 34.824022, step: 63, phase: "warmup", keystream: 0},
                {x: -9.674130, y: -12.033680, z: 35.089066, step: 64, phase: "warmup", keystream: 0},
                {x: -9.910085, y: -11.227537, z: 35.317512, step: 65, phase: "warmup", keystream: 0},
                {x: -10.041830, y: -10.390090, z: 35.488370, step: 66, phase: "warmup", keystream: 0},
                {x: -10.076656, y: -9.534220, z: 35.585369, step: 67, phase: "warmup", keystream: 0},
                {x: -10.022413, y: -8.674526, z: 35.597156, step: 68, phase: "warmup", keystream: 0},
                {x: -9.887624, y: -7.826363, z: 35.517295, step: 69, phase: "warmup", keystream: 0},
                {x: -9.681498, y: -7.004817, z: 35.344009, step: 70, phase: "warmup", keystream: 0},
                {x: -9.413830, y: -6.223759, z: 35.079673, step: 71, phase: "warmup", keystream: 0},
                {x: -9.094823, y: -5.495053, z: 34.730109, step: 72, phase: "warmup", keystream: 0},
                {x: -8.734846, y: -4.828011, z: 34.303738, step: 73, phase: "warmup", keystream: 0},
                {x: -8.344162, y: -4.229109, z: 33.810691, step: 74, phase: "warmup", keystream: 0},
                {x: -7.932657, y: -3.701964, z: 33.261957, step: 75, phase: "warmup", keystream: 0},
                {x: -7.509588, y: -3.247532, z: 32.668635, step: 76, phase: "warmup", keystream: 0},
                {x: -7.083382, y: -2.864461, z: 32.041348, step: 77, phase: "warmup", keystream: 0},
                {x: -6.661490, y: -2.549553, z: 31.389813, step: 78, phase: "warmup", keystream: 0},
                {x: -6.250296, y: -2.298245, z: 30.722589, step: 79, phase: "warmup", keystream: 0},
                {x: -5.855091, y: -2.105093, z: 30.046967, step: 80, phase: "warmup", keystream: 0},
                {x: -5.480091, y: -1.964190, z: 29.368970, step: 81, phase: "warmup", keystream: 0},
                {x: -5.128501, y: -1.869527, z: 28.693437, step: 82, phase: "warmup", keystream: 0},
                {x: -4.802604, y: -1.815269, z: 28.024157, step: 83, phase: "warmup", keystream: 0},
                {x: -4.503870, y: -1.795956, z: 27.364026, step: 84, phase: "warmup", keystream: 0},
                {x: -4.233079, y: -1.806640, z: 26.715207, step: 85, phase: "warmup", keystream: 0},
                {x: -3.990435, y: -1.842960, z: 26.079278, step: 86, phase: "warmup", keystream: 0},
                {x: -3.775687, y: -1.901176, z: 25.457372, step: 87, phase: "warmup", keystream: 0},
                {x: -3.588236, y: -1.978165, z: 24.850291, step: 88, phase: "warmup", keystream: 0},
                {x: -3.427229, y: -2.071403, z: 24.258598, step: 89, phase: "warmup", keystream: 0},
                {x: -3.291647, y: -2.178915, z: 23.682694, step: 90, phase: "warmup", keystream: 0},
                {x: -3.180373, y: -2.299236, z: 23.122878, step: 91, phase: "warmup", keystream: 0},
                {x: -3.092260, y: -2.431355, z: 22.579392, step: 92, phase: "warmup", keystream: 0},
                {x: -3.026169, y: -2.574661, z: 22.052459, step: 93, phase: "warmup", keystream: 0},
                {x: -2.981018, y: -2.728897, z: 21.542307, step: 94, phase: "warmup", keystream: 0},
                {x: -2.955806, y: -2.894113, z: 21.049194, step: 95, phase: "warmup", keystream: 0},
                {x: -2.949637, y: -3.070624, z: 20.573427, step: 96, phase: "warmup", keystream: 0},
                {x: -2.961736, y: -3.258975, z: 20.115374, step: 97, phase: "warmup", keystream: 0},
                {x: -2.991459, y: -3.459907, z: 19.675486, step: 98, phase: "warmup", keystream: 0},
                {x: -3.038304, y: -3.674332, z: 19.254308, step: 99, phase: "warmup", keystream: 0},
                {x: -3.101907, y: -3.903309, z: 18.852498, step: 100, phase: "warmup", keystream: 0},
                {x: -3.182047, y: -4.148023, z: 18.470841, step: 101, phase: "warmup", keystream: 0},
                {x: -3.278645, y: -4.409765, z: 18.110278, step: 102, phase: "warmup", keystream: 0},
                {x: -3.391757, y: -4.689917, z: 17.771917, step: 103, phase: "warmup", keystream: 0},
                {x: -3.521573, y: -4.989929, z: 17.457070, step: 104, phase: "warmup", keystream: 0},
                {x: -3.668408, y: -5.311307, z: 17.167272, step: 105, phase: "warmup", keystream: 0},
                {x: -3.832698, y: -5.655582, z: 16.904319, step: 106, phase: "warmup", keystream: 0},
                {x: -4.014987, y: -6.024291, z: 16.670298, step: 107, phase: "warmup", keystream: 0},
                {x: -4.215917, y: -6.418934, z: 16.467632, step: 108, phase: "warmup", keystream: 0},
                {x: -4.436219, y: -6.840939, z: 16.299112, step: 109, phase: "warmup", keystream: 0},
                {x: -4.676691, y: -7.291607, z: 16.167948, step: 110, phase: "warmup", keystream: 0},
                {x: -4.938182, y: -7.772039, z: 16.077808, step: 111, phase: "warmup", keystream: 0},
                {x: -5.221568, y: -8.283059, z: 16.032864, step: 112, phase: "warmup", keystream: 0},
                {x: -5.527717, y: -8.825100, z: 16.037827, step: 113, phase: "warmup", keystream: 0},
                {x: -5.857456, y: -9.398084, z: 16.097978, step: 114, phase: "warmup", keystream: 0},
                {x: -6.211518, y: -10.001259, z: 16.219187, step: 115, phase: "warmup", keystream: 0},
                {x: -6.590492, y: -10.633014, z: 16.407906, step: 116, phase: "warmup", keystream: 0},
                {x: -6.994745, y: -11.290660, z: 16.671129, step: 117, phase: "warmup", keystream: 0},
                {x: -7.424336, y: -11.970179, z: 17.016319, step: 118, phase: "warmup", keystream: 0},
                {x: -7.878920, y: -12.665942, z: 17.451257, step: 119, phase: "warmup", keystream: 0},
                {x: -8.357623, y: -13.370410, z: 17.983829, step: 120, phase: "warmup", keystream: 0},
                {x: -8.858901, y: -14.073820, z: 18.621709, step: 121, phase: "warmup", keystream: 0},
                {x: -9.380393, y: -14.763895, z: 19.371916, step: 122, phase: "warmup", keystream: 0},
                {x: -9.918743, y: -15.425604, z: 20.240243, step: 123, phase: "warmup", keystream: 0},
                {x: -10.469429, y: -16.041019, z: 21.230529, step: 124, phase: "warmup", keystream: 0},
                {x: -11.026588, y: -16.589334, z: 22.343785, step: 125, phase: "warmup", keystream: 0},
                {x: -11.582863, y: -17.047128, z: 23.577188, step: 126, phase: "warmup", keystream: 0},
                {x: -12.129289, y: -17.388945, z: 24.923009, step: 127, phase: "warmup", keystream: 0},
                {x: -12.655255, y: -17.588272, z: 26.367550, step: 128, phase: "warmup", keystream: 0},
                {x: -13.148557, y: -17.618980, z: 27.890256, step: 129, phase: "warmup", keystream: 0},
                {x: -13.595599, y: -17.457220, z: 29.463158, step: 130, phase: "warmup", keystream: 0},
                {x: -13.981761, y: -17.083723, z: 31.050887, step: 131, phase: "warmup", keystream: 0},
                {x: -14.291957, y: -16.486318, z: 32.611469, step: 132, phase: "warmup", keystream: 0},
                {x: -14.511393, y: -15.662386, z: 34.098047, step: 133, phase: "warmup", keystream: 0},
                {x: -14.626493, y: -14.620850, z: 35.461597, step: 134, phase: "warmup", keystream: 0},
                {x: -14.625928, y: -13.383272, z: 36.654472, step: 135, phase: "warmup", keystream: 0},
                {x: -14.501663, y: -11.983642, z: 37.634447, step: 136, phase: "warmup", keystream: 0},
                {x: -14.249861, y: -10.466651, z: 38.368689, step: 137, phase: "warmup", keystream: 0},
                {x: -13.871540, y: -8.884461, z: 38.837007, step: 138, phase: "warmup", keystream: 0},
                {x: -13.372832, y: -7.292356, z: 39.033765, step: 139, phase: "warmup", keystream: 0},
                {x: -12.764784, y: -5.743906, z: 38.968059, step: 140, phase: "warmup", keystream: 0},
                {x: -12.062696, y: -4.286418, z: 38.662108, step: 141, phase: "warmup", keystream: 0},
                {x: -11.285069, y: -2.957416, z: 38.148176, step: 142, phase: "warmup", keystream: 0},
                {x: -10.452303, y: -1.782613, z: 37.464638, step: 143, phase: "warmup", keystream: 0},
                {x: -9.585334, y: -0.775514, z: 36.651905, step: 144, phase: "warmup", keystream: 0},
                {x: -8.704352, y: 0.061555, z: 35.748856, step: 145, phase: "warmup", keystream: 0},
                {x: -7.827762, y: 0.735427, z: 34.790196, step: 146, phase: "warmup", keystream: 0},
                {x: -6.971443, y: 1.259593, z: 33.804890, step: 147, phase: "warmup", keystream: 0},
                {x: -6.148339, y: 1.651682, z: 32.815614, step: 148, phase: "warmup", keystream: 0},
                {x: -5.368337, y: 1.931245, z: 31.838980, step: 149, phase: "warmup", keystream: 0},
                {x: -4.638379, y: 2.118022, z: 30.886265, step: 150, phase: "warmup", keystream: 0},
                {x: -3.962739, y: 2.230718, z: 29.964389, step: 151, phase: "warmup", keystream: 0},
                {x: -3.343393, y: 2.286254, z: 29.076941, step: 152, phase: "warmup", keystream: 0},
                {x: -2.780428, y: 2.299398, z: 28.225118, step: 153, phase: "warmup", keystream: 0},
                {x: -2.272446, y: 2.282663, z: 27.408515, step: 154, phase: "warmup", keystream: 0},
                {x: -1.816935, y: 2.246396, z: 26.625749, step: 155, phase: "warmup", keystream: 0},
                {x: -1.410602, y: 2.198962, z: 25.874913, step: 156, phase: "warmup", keystream: 0},
                {x: -1.049645, y: 2.146996, z: 25.153897, step: 157, phase: "warmup", keystream: 0},
                {x: -0.729981, y: 2.095652, z: 24.460591, step: 158, phase: "warmup", keystream: 0},
                {x: -0.447418, y: 2.048859, z: 23.793010, step: 159, phase: "warmup", keystream: 0},
                {x: -0.197790, y: 2.009547, z: 23.149363, step: 160, phase: "warmup", keystream: 0},
                {x: 0.022944, y: 1.979858, z: 22.528072, step: 161, phase: "warmup", keystream: 0},
                {x: 0.218635, y: 1.961315, z: 21.927778, step: 162, phase: "warmup", keystream: 0},
                {x: 0.392903, y: 1.954977, z: 21.347325, step: 163, phase: "warmup", keystream: 0},
                {x: 0.549110, y: 1.961566, z: 20.785744, step: 164, phase: "warmup", keystream: 0},
                {x: 0.690356, y: 1.981565, z: 20.242229, step: 165, phase: "warmup", keystream: 0},
                {x: 0.819477, y: 2.015305, z: 19.716116, step: 166, phase: "warmup", keystream: 0},
                {x: 0.939060, y: 2.063037, z: 19.206868, step: 167, phase: "warmup", keystream: 0},
                {x: 1.051457, y: 2.124979, z: 18.714058, step: 168, phase: "warmup", keystream: 0},
                {x: 1.158810, y: 2.201367, z: 18.237360, step: 169, phase: "warmup", keystream: 0},
                {x: 1.263065, y: 2.292484, z: 17.776540, step: 170, phase: "warmup", keystream: 0},
                {x: 1.366007, y: 2.398688, z: 17.331454, step: 171, phase: "warmup", keystream: 0},
                {x: 1.469275, y: 2.520434, z: 16.902048, step: 172, phase: "warmup", keystream: 0},
                {x: 1.574391, y: 2.658289, z: 16.488359, step: 173, phase: "warmup", keystream: 0},
                {x: 1.682781, y: 2.812945, z: 16.090521, step: 174, phase: "warmup", keystream: 0},
                {x: 1.795797, y: 2.985226, z: 15.708777, step: 175, phase: "warmup", keystream: 0},
                {x: 1.914740, y: 3.176099, z: 15.343484, step: 176, phase: "warmup", keystream: 0},
                {x: 2.040876, y: 3.386677, z: 14.995139, step: 177, phase: "warmup", keystream: 0},
                {x: 2.175456, y: 3.618224, z: 14.664386, step: 178, phase: "warmup", keystream: 0},
                {x: 2.319733, y: 3.872152, z: 14.352049, step: 179, phase: "warmup", keystream: 0},
                {x: 2.474975, y: 4.150026, z: 14.059151, step: 180, phase: "warmup", keystream: 0},
                {x: 2.642480, y: 4.453559, z: 13.786953, step: 181, phase: "warmup", keystream: 0},
                {x: 2.823588, y: 4.784600, z: 13.536985, step: 182, phase: "warmup", keystream: 0},
                {x: 3.019689, y: 5.145130, z: 13.311096, step: 183, phase: "warmup", keystream: 0},
                {x: 3.232233, y: 5.537238, z: 13.111500, step: 184, phase: "warmup", keystream: 0},
                {x: 3.462734, y: 5.963097, z: 12.940837, step: 185, phase: "warmup", keystream: 0},
                {x: 3.712770, y: 6.424924, z: 12.802234, step: 186, phase: "warmup", keystream: 0},
                {x: 3.983985, y: 6.924933, z: 12.699384, step: 187, phase: "warmup", keystream: 0},
                {x: 4.278080, y: 7.465258, z: 12.636622, step: 188, phase: "warmup", keystream: 0},
                {x: 4.596798, y: 8.047863, z: 12.619015, step: 189, phase: "warmup", keystream: 0},
                {x: 4.941904, y: 8.674417, z: 12.652452, step: 190, phase: "warmup", keystream: 0},
                {x: 5.315156, y: 9.346134, z: 12.743735, step: 191, phase: "warmup", keystream: 0},
                {x: 5.718254, y: 10.063567, z: 12.900663, step: 192, phase: "warmup", keystream: 0},
                {x: 6.152785, y: 10.826350, z: 13.132106, step: 193, phase: "warmup", keystream: 0},
                {x: 6.620141, y: 11.632876, z: 13.448038, step: 194, phase: "warmup", keystream: 0},
                {x: 7.121415, y: 12.479908, z: 13.859537, step: 195, phase: "warmup", keystream: 0},
                {x: 7.657264, y: 13.362110, z: 14.378695, step: 196, phase: "warmup", keystream: 0},
                {x: 8.227749, y: 14.271508, z: 15.018435, step: 197, phase: "warmup", keystream: 0},
                {x: 8.832125, y: 15.196883, z: 15.792168, step: 198, phase: "warmup", keystream: 0},
                {x: 9.468600, y: 16.123125, z: 16.713251, step: 199, phase: "warmup", keystream: 0},
                {x: 10.134053, y: 17.030591, z: 17.794198, step: 200, phase: "warmup", keystream: 0},
                {x: 10.823707, y: 17.894547, z: 19.045576, step: 201, phase: "warmup", keystream: 0},
                {x: 11.530791, y: 18.684802, z: 20.474547, step: 202, phase: "warmup", keystream: 0},
                {x: 12.246192, y: 19.365698, z: 22.083064, step: 203, phase: "warmup", keystream: 0},
                {x: 12.958143, y: 19.896640, z: 23.865743, step: 204, phase: "warmup", keystream: 0},
                {x: 13.651992, y: 20.233397, z: 25.807558, step: 205, phase: "warmup", keystream: 0},
                {x: 14.310133, y: 20.330375, z: 27.881619, step: 206, phase: "warmup", keystream: 0},
                {x: 14.912157, y: 20.144012, z: 30.047412, step: 207, phase: "warmup", keystream: 0},
                {x: 15.435342, y: 19.637258, z: 32.250055, step: 208, phase: "warmup", keystream: 0},
                {x: 15.855534, y: 18.784875, z: 34.421131, step: 209, phase: "warmup", keystream: 0},
                {x: 16.148468, y: 17.578922, z: 36.481677, step: 210, phase: "warmup", keystream: 0},
                {x: 16.291513, y: 16.033472, z: 38.347559, step: 211, phase: "warmup", keystream: 0},
                {x: 16.265709, y: 14.187363, z: 39.937052, step: 212, phase: "warmup", keystream: 0},
                {x: 16.057875, y: 12.103843, z: 41.179739, step: 213, phase: "warmup", keystream: 0},
                {x: 15.662472, y: 9.866419, z: 42.025233, step: 214, phase: "warmup", keystream: 0},
                {x: 15.082866, y: 7.571056, z: 42.449885, step: 215, phase: "warmup", keystream: 0},
                {x: 14.331685, y: 5.315889, z: 42.459820, step: 216, phase: "warmup", keystream: 0},
                {x: 13.430106, y: 3.190394, z: 42.089415, step: 217, phase: "warmup", keystream: 0},
                {x: 12.406134, y: 1.266267, z: 41.395504, step: 218, phase: "warmup", keystream: 0},
                {x: 11.292148, y: -0.408260, z: 40.448719, step: 219, phase: "warmup", keystream: 0},
                {x: 10.122107, y: -1.809905, z: 39.323985, step: 220, phase: "warmup", keystream: 0},
                {x: 8.928906, y: -2.938032, z: 38.092145, step: 221, phase: "warmup", keystream: 0},
                {x: 7.742212, y: -3.809770, z: 36.814020, step: 222, phase: "warmup", keystream: 0},
                {x: 6.587014, y: -4.454072, z: 35.537352, step: 223, phase: "warmup", keystream: 0},
                {x: 5.482905, y: -4.906018, z: 34.296299, step: 224, phase: "warmup", keystream: 0},
                {x: 4.444013, y: -5.202178, z: 33.112739, step: 225, phase: "warmup", keystream: 0},
                {x: 3.479394, y: -5.377367, z: 31.998547, step: 226, phase: "warmup", keystream: 0},
                {x: 2.593718, y: -5.462718, z: 30.958153, step: 227, phase: "warmup", keystream: 0},
                {x: 1.788074, y: -5.484817, z: 29.990915, step: 228, phase: "warmup", keystream: 0},
                {x: 1.060785, y: -5.465568, z: 29.093084, step: 229, phase: "warmup", keystream: 0},
                {x: 0.408150, y: -5.422508, z: 28.259291, step: 230, phase: "warmup", keystream: 0},
                {x: -0.174916, y: -5.369341, z: 27.483578, step: 231, phase: "warmup", keystream: 0},
                {x: -0.694359, y: -5.316551, z: 26.760074, step: 232, phase: "warmup", keystream: 0},
                {x: -1.156578, y: -5.271995, z: 26.083388, step: 233, phase: "warmup", keystream: 0},
                {x: -1.568119, y: -5.241442, z: 25.448806, step: 234, phase: "warmup", keystream: 0},
                {x: -1.935452, y: -5.229033, z: 24.852363, step: 235, phase: "warmup", keystream: 0},
                {x: -2.264810, y: -5.237664, z: 24.290839, step: 236, phase: "warmup", keystream: 0},
                {x: -2.562095, y: -5.269293, z: 23.761706, step: 237, phase: "warmup", keystream: 0},
                {x: -2.832815, y: -5.325189, z: 23.263065, step: 238, phase: "warmup", keystream: 0},
                {x: -3.082052, y: -5.406126, z: 22.793569, step: 239, phase: "warmup", keystream: 0},
                {x: -3.314460, y: -5.512529, z: 22.352361, step: 240, phase: "warmup", keystream: 0},
                {x: -3.534267, y: -5.644593, z: 21.939008, step: 241, phase: "warmup", keystream: 0},
                {x: -3.745299, y: -5.802359, z: 21.553463, step: 242, phase: "warmup", keystream: 0},
                {x: -3.951005, y: -5.985777, z: 21.196020, step: 243, phase: "warmup", keystream: 0},
                {x: -4.154482, y: -6.194745, z: 20.867291, step: 244, phase: "warmup", keystream: 0},
                {x: -4.358509, y: -6.429125, z: 20.568189, step: 245, phase: "warmup", keystream: 0},
                {x: -4.565570, y: -6.688750, z: 20.299918, step: 246, phase: "warmup", keystream: 0},
                {x: -4.777888, y: -6.973415, z: 20.063967, step: 247, phase: "warmup", keystream: 0},
                {x: -4.997441, y: -7.282855, z: 19.862109, step: 248, phase: "warmup", keystream: 0},
                {x: -5.225982, y: -7.616713, z: 19.696410, step: 249, phase: "warmup", keystream: 0},
                {x: -5.465055, y: -7.974490, z: 19.569220, step: 250, phase: "warmup", keystream: 0},
                {x: -5.715999, y: -8.355492, z: 19.483184, step: 251, phase: "warmup", keystream: 0},
                {x: -5.979948, y: -8.758758, z: 19.441233, step: 252, phase: "warmup", keystream: 0},
                {x: -6.257829, y: -9.182980, z: 19.446569, step: 253, phase: "warmup", keystream: 0},
                {x: -6.550344, y: -9.626410, z: 19.502649, step: 254, phase: "warmup", keystream: 0},
                {x: -6.857951, y: -10.086751, z: 19.613141, step: 255, phase: "warmup", keystream: 0},
                {x: -7.180831, y: -10.561050, z: 19.781869, step: 256, phase: "warmup", keystream: 0},
                {x: -7.518853, y: -11.045570, z: 20.012723, step: 257, phase: "warmup", keystream: 0},
                {x: -7.871525, y: -11.535666, z: 20.309551, step: 258, phase: "warmup", keystream: 0},
                {x: -8.237939, y: -12.025665, z: 20.675996, step: 259, phase: "warmup", keystream: 0},
                {x: -8.616711, y: -12.508755, z: 21.115303, step: 260, phase: "warmup", keystream: 0},
                {x: -9.005916, y: -12.976902, z: 21.630071, step: 261, phase: "warmup", keystream: 0},
                {x: -9.403014, y: -13.420803, z: 22.221958, step: 262, phase: "warmup", keystream: 0},
                {x: -9.804793, y: -13.829906, z: 22.891333, step: 263, phase: "warmup", keystream: 0},
                {x: -10.207304, y: -14.192501, z: 23.636891, step: 264, phase: "warmup", keystream: 0},
                {x: -10.605824, y: -14.495932, z: 24.455246, step: 265, phase: "warmup", keystream: 0},
                {x: -10.994835, y: -14.726923, z: 25.340519, step: 266, phase: "warmup", keystream: 0},
                {x: -11.368044, y: -14.872059, z: 26.283972, step: 267, phase: "warmup", keystream: 0},
                {x: -11.718445, y: -14.918417, z: 27.273729, step: 268, phase: "warmup", keystream: 0},
                {x: -12.038442, y: -14.854341, z: 28.294636, step: 269, phase: "warmup", keystream: 0},
                {x: -12.320032, y: -14.670328, z: 29.328343, step: 270, phase: "warmup", keystream: 0},
                {x: -12.555062, y: -14.359972, z: 30.353643, step: 271, phase: "warmup", keystream: 0},
                {x: -12.735553, y: -13.920871, z: 31.347116, step: 272, phase: "warmup", keystream: 0},
                {x: -12.854085, y: -13.355389, z: 32.284093, step: 273, phase: "warmup", keystream: 0},
                {x: -12.904215, y: -12.671154, z: 33.139897, step: 274, phase: "warmup", keystream: 0},
                {x: -12.880909, y: -11.881179, z: 33.891279, step: 275, phase: "warmup", keystream: 0},
                {x: -12.780936, y: -11.003517, z: 34.517916, step: 276, phase: "warmup", keystream: 0},
                {x: -12.603194, y: -10.060431, z: 35.003790, step: 277, phase: "warmup", keystream: 0},
                {x: -12.348918, y: -9.077125, z: 35.338291, step: 278, phase: "warmup", keystream: 0},
                {x: -12.021738, y: -8.080155, z: 35.516864, step: 279, phase: "warmup", keystream: 0},
                {x: -11.627580, y: -7.095695, z: 35.541122, step: 280, phase: "warmup", keystream: 0},
                {x: -11.174392, y: -6.147888, z: 35.418417, step: 281, phase: "warmup", keystream: 0},
                {x: -10.671741, y: -5.257447, z: 35.160915, step: 282, phase: "warmup", keystream: 0},
                {x: -10.130312, y: -4.440678, z: 34.784352, step: 283, phase: "warmup", keystream: 0},
                {x: -9.561348, y: -3.708995, z: 34.306623, step: 284, phase: "warmup", keystream: 0},
                {x: -8.976113, y: -3.068907, z: 33.746410, step: 285, phase: "warmup", keystream: 0},
                {x: -8.385392, y: -2.522413, z: 33.121974, step: 286, phase: "warmup", keystream: 0},
                {x: -7.799095, y: -2.067692, z: 32.450236, step: 287, phase: "warmup", keystream: 0},
                {x: -7.225954, y: -1.699937, z: 31.746158, step: 288, phase: "warmup", keystream: 0},
                {x: -6.673353, y: -1.412242, z: 31.022430, step: 289, phase: "warmup", keystream: 0},
                {x: -6.147241, y: -1.196422, z: 30.289409, step: 290, phase: "warmup", keystream: 0},
                {x: -5.652159, y: -1.043722, z: 29.555238, step: 291, phase: "warmup", keystream: 0},
                {x: -5.191316, y: -0.945380, z: 28.826092, step: 292, phase: "warmup", keystream: 0},
                {x: -4.766722, y: -0.893042, z: 28.106473, step: 293, phase: "warmup", keystream: 0},
                {x: -4.379354, y: -0.879036, z: 27.399536, step: 294, phase: "warmup", keystream: 0},
                {x: -4.029322, y: -0.896542, z: 26.707378, step: 295, phase: "warmup", keystream: 0},
                {x: -3.716044, y: -0.939660, z: 26.031306, step: 296, phase: "warmup", keystream: 0},
                {x: -3.438406, y: -1.003421, z: 25.372056, step: 297, phase: "warmup", keystream: 0},
                {x: -3.194907, y: -1.083747, z: 24.729970, step: 298, phase: "warmup", keystream: 0},
                {x: -2.983791, y: -1.177383, z: 24.105128, step: 299, phase: "warmup", keystream: 0},
                {x: -2.803151, y: -1.281824, z: 23.497456, step: 300, phase: "warmup", keystream: 0},
                {x: -2.651018, y: -1.395219, z: 22.906788, step: 301, phase: "warmup", keystream: 0},
                {x: -2.525438, y: -1.516289, z: 22.332928, step: 302, phase: "warmup", keystream: 0},
                {x: -2.424523, y: -1.644245, z: 21.775676, step: 303, phase: "warmup", keystream: 0},
                {x: -2.346495, y: -1.778712, z: 21.234857, step: 304, phase: "warmup", keystream: 0},
                {x: -2.289717, y: -1.919669, z: 20.710331, step: 305, phase: "warmup", keystream: 0},
                {x: -2.252712, y: -2.067385, z: 20.202011, step: 306, phase: "warmup", keystream: 0},
                {x: -2.234180, y: -2.222377, z: 19.709863, step: 307, phase: "warmup", keystream: 0},
                {x: -2.232999, y: -2.385370, z: 19.233918, step: 308, phase: "warmup", keystream: 0},
                {x: -2.248236, y: -2.557263, z: 18.774279, step: 309, phase: "warmup", keystream: 0},
                {x: -2.279139, y: -2.739106, z: 18.331125, step: 310, phase: "warmup", keystream: 0},
                {x: -2.325136, y: -2.932083, z: 17.904723, step: 311, phase: "warmup", keystream: 0},
                {x: -2.385830, y: -3.137491, z: 17.495439, step: 312, phase: "warmup", keystream: 0},
                {x: -2.460997, y: -3.356737, z: 17.103749, step: 313, phase: "warmup", keystream: 0},
                {x: -2.550571, y: -3.591326, z: 16.730258, step: 314, phase: "warmup", keystream: 0},
                {x: -2.654646, y: -3.842855, z: 16.375717, step: 315, phase: "warmup", keystream: 0},
                {x: -2.773467, y: -4.113010, z: 16.041045, step: 316, phase: "warmup", keystream: 0},
                {x: -2.907421, y: -4.403558, z: 15.727357, step: 317, phase: "warmup", keystream: 0},
                {x: -3.057035, y: -4.716340, z: 15.435991, step: 318, phase: "warmup", keystream: 0},
                {x: -3.222965, y: -5.053262, z: 15.168545, step: 319, phase: "warmup", keystream: 0},
                {x: -3.405995, y: -5.416283, z: 14.926915, step: 320, phase: "warmup", keystream: 0},
                {x: -3.607024, y: -5.807389, z: 14.713342, step: 321, phase: "warmup", keystream: 0},
                {x: -3.827060, y: -6.228568, z: 14.530460, step: 322, phase: "warmup", keystream: 0},
                {x: -4.067211, y: -6.681770, z: 14.381353, step: 323, phase: "warmup", keystream: 0},
                {x: -4.328667, y: -7.168851, z: 14.269612, step: 324, phase: "warmup", keystream: 0},
                {x: -4.612685, y: -7.691505, z: 14.199404, step: 325, phase: "warmup", keystream: 0},
                {x: -4.920567, y: -8.251168, z: 14.175538, step: 326, phase: "warmup", keystream: 0},
                {x: -5.253628, y: -8.848899, z: 14.203528, step: 327, phase: "warmup", keystream: 0},
                {x: -5.613155, y: -9.485225, z: 14.289656, step: 328, phase: "warmup", keystream: 0},
                {x: -6.000362, y: -10.159955, z: 14.441019, step: 329, phase: "warmup", keystream: 0},
                {x: -6.416321, y: -10.871944, z: 14.665559, step: 330, phase: "warmup", keystream: 0},
                {x: -6.861883, y: -11.618805, z: 14.972056, step: 331, phase: "warmup", keystream: 0},
                {x: -7.337575, y: -12.396579, z: 15.370070, step: 332, phase: "warmup", keystream: 0},
                {x: -7.843476, y: -13.199344, z: 15.869810, step: 333, phase: "warmup", keystream: 0},
                {x: -8.379063, y: -14.018779, z: 16.481902, step: 334, phase: "warmup", keystream: 0},
                {x: -8.943034, y: -14.843700, z: 17.217027, step: 335, phase: "warmup", keystream: 0},
                {x: -9.533101, y: -15.659588, z: 18.085384, step: 336, phase: "warmup", keystream: 0},
                {x: -10.145750, y: -16.448162, z: 19.095951, step: 337, phase: "warmup", keystream: 0},
                {x: -10.775991, y: -17.187063, z: 20.255515, step: 338, phase: "warmup", keystream: 0},
                {x: -11.417098, y: -17.849738, z: 21.567444, step: 339, phase: "warmup", keystream: 0},
                {x: -12.060362, y: -18.405651, z: 23.030235, step: 340, phase: "warmup", keystream: 0},
                {x: -12.694891, y: -18.820967, z: 24.635883, step: 341, phase: "warmup", keystream: 0},
                {x: -13.307499, y: -19.059828, z: 26.368228, step: 342, phase: "warmup", keystream: 0},
                {x: -13.882732, y: -19.086378, z: 28.201461, step: 343, phase: "warmup", keystream: 0},
                {x: -14.403096, y: -18.867546, z: 30.099133, step: 344, phase: "warmup", keystream: 0},
                {x: -14.849541, y: -18.376530, z: 32.014000, step: 345, phase: "warmup", keystream: 0},
                {x: -15.202240, y: -17.596704, z: 33.889124, step: 346, phase: "warmup", keystream: 0},
                {x: -15.441686, y: -16.525458, z: 35.660507, step: 347, phase: "warmup", keystream: 0},
                {x: -15.550064, y: -15.177292, z: 37.261370, step: 348, phase: "warmup", keystream: 0},
                {x: -15.512786, y: -13.585371, z: 38.627812, step: 349, phase: "warmup", keystream: 0},
                {x: -15.320045, y: -11.800847, z: 39.705206, step: 350, phase: "warmup", keystream: 0},
                {x: -14.968125, y: -9.889596, z: 40.454296, step: 351, phase: "warmup", keystream: 0},
                {x: -14.460272, y: -7.926525, z: 40.855802, step: 352, phase: "warmup", keystream: 0},
                {x: -13.806897, y: -5.988276, z: 40.912511, step: 353, phase: "warmup", keystream: 0},
                {x: -13.025035, y: -4.145576, z: 40.648306, step: 354, phase: "warmup", keystream: 0},
                {x: -12.137089, y: -2.456674, z: 40.104314, step: 355, phase: "warmup", keystream: 0},
                {x: -11.169048, y: -0.962996, z: 39.333034, step: 356, phase: "warmup", keystream: 0},
                {x: -10.148443, y: 0.312426, z: 38.391711, step: 357, phase: "warmup", keystream: 0},
                {x: -9.102356, y: 1.363898, z: 37.336225, step: 358, phase: "warmup", keystream: 0},
                {x: -8.055730, y: 2.200076, z: 36.216446, step: 359, phase: "warmup", keystream: 0},
                {x: -7.030150, y: 2.839970, z: 35.073442, step: 360, phase: "warmup", keystream: 0},
                {x: -6.043138, y: 3.308844, z: 33.938496, step: 361, phase: "warmup", keystream: 0},
                {x: -5.107940, y: 3.634627, z: 32.833511, step: 362, phase: "warmup", keystream: 0},
                {x: -4.233683, y: 3.845173, z: 31.772296, step: 363, phase: "warmup", keystream: 0},
                {x: -3.425797, y: 3.966429, z: 30.762243, step: 364, phase: "warmup", keystream: 0},
                {x: -2.686575, y: 4.021393, z: 29.806034, step: 365, phase: "warmup", keystream: 0},
                {x: -2.015778, y: 4.029700, z: 28.903169, step: 366, phase: "warmup", keystream: 0},
                {x: -1.411230, y: 4.007609, z: 28.051188, step: 367, phase: "warmup", keystream: 0},
                {x: -0.869346, y: 3.968255, z: 27.246600, step: 368, phase: "warmup", keystream: 0},
                {x: -0.385586, y: 3.922023, z: 26.485526, step: 369, phase: "warmup", keystream: 0},
                {x: 0.045175, y: 3.876963, z: 25.764122, step: 370, phase: "warmup", keystream: 0},
                {x: 0.428353, y: 3.839203, z: 25.078831, step: 371, phase: "warmup", keystream: 0},
                {x: 0.769438, y: 3.813324, z: 24.426507, step: 372, phase: "warmup", keystream: 0},
                {x: 1.073827, y: 3.802687, z: 23.804475, step: 373, phase: "warmup", keystream: 0},
                {x: 1.346713, y: 3.809713, z: 23.210523, step: 374, phase: "warmup", keystream: 0},
                {x: 1.593013, y: 3.836116, z: 22.642882, step: 375, phase: "warmup", keystream: 0},
                {x: 1.817323, y: 3.883094, z: 22.100181, step: 376, phase: "warmup", keystream: 0},
                {x: 2.023900, y: 3.951482, z: 21.581412, step: 377, phase: "warmup", keystream: 0},
                {x: 2.216659, y: 4.041873, z: 21.085881, step: 378, phase: "warmup", keystream: 0},
                {x: 2.399180, y: 4.154717, z: 20.613186, step: 379, phase: "warmup", keystream: 0},
                {x: 2.574734, y: 4.290393, z: 20.163180, step: 380, phase: "warmup", keystream: 0},
                {x: 2.746300, y: 4.449266, z: 19.735961, step: 381, phase: "warmup", keystream: 0},
                {x: 2.916596, y: 4.631729, z: 19.331859, step: 382, phase: "warmup", keystream: 0},
                {x: 3.088109, y: 4.838226, z: 18.951432, step: 383, phase: "warmup", keystream: 0},
                {x: 3.263121, y: 5.069273, z: 18.595470, step: 384, phase: "warmup", keystream: 0},
                {x: 3.443736, y: 5.325462, z: 18.265007, step: 385, phase: "warmup", keystream: 0},
                {x: 3.631909, y: 5.607455, z: 17.961335, step: 386, phase: "warmup", keystream: 0},
                {x: 3.829463, y: 5.915975, z: 17.686024, step: 387, phase: "warmup", keystream: 0},
                {x: 4.038115, y: 6.251786, z: 17.440947, step: 388, phase: "warmup", keystream: 0},
                {x: 4.259482, y: 6.615654, z: 17.228309, step: 389, phase: "warmup", keystream: 0},
                {x: 4.495099, y: 7.008316, z: 17.050680, step: 390, phase: "warmup", keystream: 0},
                {x: 4.746421, y: 7.430416, z: 16.911026, step: 391, phase: "warmup", keystream: 0},
                {x: 5.014820, y: 7.882441, z: 16.812744, step: 392, phase: "warmup", keystream: 0},
                {x: 5.301582, y: 8.364637, z: 16.759695, step: 393, phase: "warmup", keystream: 0},
                {x: 5.607888, y: 8.876905, z: 16.756227, step: 394, phase: "warmup", keystream: 0},
                {x: 5.934789, y: 9.418674, z: 16.807202, step: 395, phase: "warmup", keystream: 0},
                {x: 6.283178, y: 9.988756, z: 16.917988, step: 396, phase: "warmup", keystream: 0},
                {x: 6.653736, y: 10.585171, z: 17.094453, step: 397, phase: "warmup", keystream: 0},
                {x: 7.046879, y: 11.204946, z: 17.342910, step: 398, phase: "warmup", keystream: 0},
                {x: 7.462686, y: 11.843889, z: 17.670032, step: 399, phase: "warmup", keystream: 0},
                {x: 7.900806, y: 12.496343, z: 18.082703, step: 400, phase: "warmup", keystream: 0},
                {x: 8.360360, y: 13.154926, z: 18.587809, step: 401, phase: "warmup", keystream: 0},
                {x: 8.839816, y: 13.810270, z: 19.191934, step: 402, phase: "warmup", keystream: 0},
                {x: 9.336862, y: 14.450784, z: 19.900951, step: 403, phase: "warmup", keystream: 0},
                {x: 9.848254, y: 15.062473, z: 20.719509, step: 404, phase: "warmup", keystream: 0},
                {x: 10.369676, y: 15.628849, z: 21.650379, step: 405, phase: "warmup", keystream: 0},
                {x: 10.895593, y: 16.130996, z: 22.693697, step: 406, phase: "warmup", keystream: 0},
                {x: 11.419133, y: 16.547839, z: 23.846099, step: 407, phase: "warmup", keystream: 0},
                {x: 11.932004, y: 16.856700, z: 25.099823, step: 408, phase: "warmup", keystream: 0},
                {x: 12.424474, y: 17.034183, z: 26.441837, step: 409, phase: "warmup", keystream: 0},
                {x: 12.885445, y: 17.057434, z: 27.853129, step: 410, phase: "warmup", keystream: 0},
                {x: 13.302644, y: 16.905785, z: 29.308305, step: 411, phase: "warmup", keystream: 0},
                {x: 13.662958, y: 16.562688, z: 30.775666, step: 412, phase: "warmup", keystream: 0},
                {x: 13.952931, y: 16.017823, z: 32.217935, step: 413, phase: "warmup", keystream: 0},
                {x: 14.159420, y: 15.269119, z: 33.593746, step: 414, phase: "warmup", keystream: 0},
                {x: 14.270390, y: 14.324386, z: 34.859931, step: 415, phase: "warmup", keystream: 0},
                {x: 14.275790, y: 13.202203, z: 35.974479, step: 416, phase: "warmup", keystream: 0},
                {x: 14.168431, y: 11.931762, z: 36.899878, step: 417, phase: "warmup", keystream: 0},
                {x: 13.944764, y: 10.551471, z: 37.606425, step: 418, phase: "warmup", keystream: 0},
                {x: 13.605435, y: 9.106363, z: 38.074964, step: 419, phase: "warmup", keystream: 0},
                {x: 13.155528, y: 7.644557, z: 38.298592, step: 420, phase: "warmup", keystream: 0},
                {x: 12.604430, y: 6.213277, z: 38.282978, step: 421, phase: "warmup", keystream: 0},
                {x: 11.965315, y: 4.855033, z: 38.045247, step: 422, phase: "warmup", keystream: 0},
                {x: 11.254287, y: 3.604537, z: 37.611627, step: 423, phase: "warmup", keystream: 0},
                {x: 10.489312, y: 2.486772, z: 37.014315, step: 424, phase: "warmup", keystream: 0},
                {x: 9.689058, y: 1.516365, z: 36.288112, step: 425, phase: "warmup", keystream: 0},
                {x: 8.871789, y: 0.698161, z: 35.467351, step: 426, phase: "warmup", keystream: 0},
                {x: 8.054426, y: 0.028692, z: 34.583494, step: 427, phase: "warmup", keystream: 0},
                {x: 7.251852, y: -0.501858, z: 33.663579, step: 428, phase: "warmup", keystream: 0},
                {x: 6.476481, y: -0.907554, z: 32.729489, step: 429, phase: "warmup", keystream: 0},
                {x: 5.738078, y: -1.204783, z: 31.797925, step: 430, phase: "warmup", keystream: 0},
                {x: 5.043792, y: -1.410663, z: 30.880849, step: 431, phase: "warmup", keystream: 0},
                {x: 4.398346, y: -1.541860, z: 29.986209, step: 432, phase: "warmup", keystream: 0},
                {x: 3.804326, y: -1.613802, z: 29.118760, step: 433, phase: "warmup", keystream: 0},
                {x: 3.262513, y: -1.640225, z: 28.280866, step: 434, phase: "warmup", keystream: 0},
                {x: 2.772239, y: -1.632986, z: 27.473197, step: 435, phase: "warmup", keystream: 0},
                {x: 2.331717, y: -1.602052, z: 26.695308, step: 436, phase: "warmup", keystream: 0},
                {x: 1.938340, y: -1.555610, z: 25.946078, step: 437, phase: "warmup", keystream: 0},
                {x: 1.588945, y: -1.500242, z: 25.224029, step: 438, phase: "warmup", keystream: 0},
                {x: 1.280026, y: -1.441131, z: 24.527551, step: 439, phase: "warmup", keystream: 0},
                {x: 1.007911, y: -1.382271, z: 23.855036, step: 440, phase: "warmup", keystream: 0},
                {x: 0.768892, y: -1.326671, z: 23.204969, step: 441, phase: "warmup", keystream: 0},
                {x: 0.559336, y: -1.276535, z: 22.575970, step: 442, phase: "warmup", keystream: 0},
                {x: 0.375749, y: -1.233432, z: 21.966804, step: 443, phase: "warmup", keystream: 0},
                {x: 0.214831, y: -1.198428, z: 21.376388, step: 444, phase: "warmup", keystream: 0},
                {x: 0.073505, y: -1.172214, z: 20.803776, step: 445, phase: "warmup", keystream: 0},
                {x: -0.051067, y: -1.155202, z: 20.248147, step: 446, phase: "warmup", keystream: 0},
                {x: -0.161480, y: -1.147609, z: 19.708786, step: 447, phase: "warmup", keystream: 0},
                {x: -0.260093, y: -1.149521, z: 19.185072, step: 448, phase: "warmup", keystream: 0},
                {x: -0.349036, y: -1.160953, z: 18.676460, step: 449, phase: "warmup", keystream: 0},
                {x: -0.430228, y: -1.181886, z: 18.182473, step: 450, phase: "warmup", keystream: 0},
                {x: -0.505393, y: -1.212305, z: 17.702692, step: 451, phase: "warmup", keystream: 0},
                {x: -0.576085, y: -1.252224, z: 17.236747, step: 452, phase: "warmup", keystream: 0},
                {x: -0.643699, y: -1.301707, z: 16.784314, step: 453, phase: "warmup", keystream: 0},
                {x: -0.709499, y: -1.360885, z: 16.345112, step: 454, phase: "warmup", keystream: 0},
                {x: -0.774638, y: -1.429968, z: 15.918897, step: 455, phase: "warmup", keystream: 0},
                {x: -0.840171, y: -1.509253, z: 15.505471, step: 456, phase: "warmup", keystream: 0},
                {x: -0.907079, y: -1.599136, z: 15.104672, step: 457, phase: "warmup", keystream: 0},
                {x: -0.976285, y: -1.700115, z: 14.716386, step: 458, phase: "warmup", keystream: 0},
                {x: -1.048668, y: -1.812800, z: 14.340547, step: 459, phase: "warmup", keystream: 0},
                {x: -1.125081, y: -1.937914, z: 13.977142, step: 460, phase: "warmup", keystream: 0},
                {x: -1.206364, y: -2.076303, z: 13.626222, step: 461, phase: "warmup", keystream: 0},
                {x: -1.293358, y: -2.228940, z: 13.287904, step: 462, phase: "warmup", keystream: 0},
                {x: -1.386916, y: -2.396931, z: 12.962388, step: 463, phase: "warmup", keystream: 0},
                {x: -1.487918, y: -2.581521, z: 12.649967, step: 464, phase: "warmup", keystream: 0},
                {x: -1.597278, y: -2.784102, z: 12.351046, step: 465, phase: "warmup", keystream: 0},
                {x: -1.715961, y: -3.006218, z: 12.066155, step: 466, phase: "warmup", keystream: 0},
                {x: -1.844986, y: -3.249574, z: 11.795976, step: 467, phase: "warmup", keystream: 0},
                {x: -1.985445, y: -3.516041, z: 11.541371, step: 468, phase: "warmup", keystream: 0},
                {x: -2.138505, y: -3.807657, z: 11.303410, step: 469, phase: "warmup", keystream: 0},
                {x: -2.305420, y: -4.126638, z: 11.083413, step: 470, phase: "warmup", keystream: 0},
                {x: -2.487542, y: -4.475370, z: 10.882991, step: 471, phase: "warmup", keystream: 0},
                {x: -2.686325, y: -4.856409, z: 10.704105, step: 472, phase: "warmup", keystream: 0},
                {x: -2.903333, y: -5.272469, z: 10.549121, step: 473, phase: "warmup", keystream: 0},
                {x: -3.140247, y: -5.726401, z: 10.420888, step: 474, phase: "warmup", keystream: 0},
                {x: -3.398862, y: -6.221165, z: 10.322821, step: 475, phase: "warmup", keystream: 0},
                {x: -3.681092, y: -6.759776, z: 10.258995, step: 476, phase: "warmup", keystream: 0},
                {x: -3.988961, y: -7.345241, z: 10.234255, step: 477, phase: "warmup", keystream: 0},
                {x: -4.324589, y: -7.980457, z: 10.254340, step: 478, phase: "warmup", keystream: 0},
                {x: -4.690175, y: -8.668079, z: 10.326013, step: 479, phase: "warmup", keystream: 0},
                {x: -5.087966, y: -9.410339, z: 10.457201, step: 480, phase: "warmup", keystream: 0},
                {x: -5.520203, y: -10.208808, z: 10.657137, step: 481, phase: "warmup", keystream: 0},
                {x: -5.989064, y: -11.064081, z: 10.936494, step: 482, phase: "warmup", keystream: 0},
                {x: -6.496565, y: -11.975384, z: 11.307489, step: 483, phase: "warmup", keystream: 0},
                {x: -7.044447, y: -12.940070, z: 11.783944, step: 484, phase: "warmup", keystream: 0},
                {x: -7.634010, y: -13.953001, z: 12.381262, step: 485, phase: "warmup", keystream: 0},
                {x: -8.265909, y: -15.005807, z: 13.116269, step: 486, phase: "warmup", keystream: 0},
                {x: -8.939899, y: -16.086025, z: 14.006868, step: 487, phase: "warmup", keystream: 0},
                {x: -9.654511, y: -17.176136, z: 15.071426, step: 488, phase: "warmup", keystream: 0},
                {x: -10.406674, y: -18.252565, z: 16.327793, step: 489, phase: "warmup", keystream: 0},
                {x: -11.191263, y: -19.284728, z: 17.791870, step: 490, phase: "warmup", keystream: 0},
                {x: -12.000609, y: -20.234300, z: 19.475625, step: 491, phase: "warmup", keystream: 0},
                {x: -12.823978, y: -21.054934, z: 21.384514, step: 492, phase: "warmup", keystream: 0},
                {x: -13.647074, y: -21.692753, z: 23.514341, step: 493, phase: "warmup", keystream: 0},
                {x: -14.451642, y: -22.087986, z: 25.847718, step: 494, phase: "warmup", keystream: 0},
                {x: -15.215276, y: -22.178147, z: 28.350522, step: 495, phase: "warmup", keystream: 0},
                {x: -15.911563, y: -21.903032, z: 30.968974, step: 496, phase: "warmup", keystream: 0},
                {x: -16.510710, y: -21.211592, z: 33.628250, step: 497, phase: "warmup", keystream: 0},
                {x: -16.980798, y: -20.070212, z: 36.233681, step: 498, phase: "warmup", keystream: 0},
                {x: -17.289740, y: -18.471365, z: 38.675532, step: 499, phase: "warmup", keystream: 0},
                {x: -17.407902, y: -16.440880, z: 40.837835, step: 500, phase: "warmup", keystream: 0},
                {x: -17.311200, y: -14.041673, z: 42.610838, step: 501, phase: "warmup", keystream: 0},
                {x: -16.984247, y: -11.371945, z: 43.905332, step: 502, phase: "warmup", keystream: 0},
                {x: -16.423017, y: -8.556825, z: 44.665962, step: 503, phase: "warmup", keystream: 0},
                {x: -15.636398, y: -5.734203, z: 44.880158, step: 504, phase: "warmup", keystream: 0},
                {x: -14.646178, y: -3.037412, z: 44.579977, step: 505, phase: "warmup", keystream: 0},
                {x: -13.485302, y: -0.578705, z: 43.836042, step: 506, phase: "warmup", keystream: 0},
                {x: -12.194642, y: 1.562620, z: 42.745121, step: 507, phase: "warmup", keystream: 0},
                {x: -10.818916, y: 3.345109, z: 41.414695, step: 508, phase: "warmup", keystream: 0},
                {x: -9.402513, y: 4.762982, z: 39.948399, step: 509, phase: "warmup", keystream: 0},
                {x: -7.985964, y: 5.838802, z: 38.435268, step: 510, phase: "warmup", keystream: 0},
                {x: -6.603487, y: 6.613771, z: 36.944043, step: 511, phase: "warmup", keystream: 0},
                {x: -5.281761, y: 7.138252, z: 35.522129, step: 512, phase: "warmup", keystream: 0},
                {x: -4.039760, y: 7.464171, z: 34.197847, step: 513, phase: "warmup", keystream: 0},
                {x: -2.889367, y: 7.639907, z: 32.984370, step: 514, phase: "warmup", keystream: 0},
                {x: -1.836439, y: 7.707525, z: 31.884042, step: 515, phase: "warmup", keystream: 0},
                {x: -0.882043, y: 7.701777, z: 30.892257, step: 516, phase: "warmup", keystream: 0},
                {x: -0.023661, y: 7.650271, z: 30.000530, step: 517, phase: "warmup", keystream: 0},
                {x: 0.743732, y: 7.574241, z: 29.198706, step: 518, phase: "warmup", keystream: 0},
                {x: 1.426783, y: 7.489584, z: 28.476406, step: 519, phase: "warmup", keystream: 0},
                {x: 2.033063, y: 7.407891, z: 27.823895, step: 520, phase: "warmup", keystream: 0},
                {x: 2.570546, y: 7.337392, z: 27.232532, step: 521, phase: "warmup", keystream: 0},
                {x: 3.047230, y: 7.283746, z: 26.694942, step: 522, phase: "warmup", keystream: 0},
                {x: 3.470882, y: 7.250677, z: 26.205029, step: 523, phase: "warmup", keystream: 0},
                {x: 3.848862, y: 7.240471, z: 25.757891, step: 524, phase: "warmup", keystream: 0},
                {x: 4.188023, y: 7.254362, z: 25.349689, step: 525, phase: "warmup", keystream: 0},
                {x: 4.494657, y: 7.292814, z: 24.977512, step: 526, phase: "warmup", keystream: 0},
                {x: 4.774472, y: 7.355737, z: 24.639232, step: 527, phase: "warmup", keystream: 0},
                {x: 5.032599, y: 7.442638, z: 24.333383, step: 528, phase: "warmup", keystream: 0},
                {x: 5.273603, y: 7.552738, z: 24.059051, step: 529, phase: "warmup", keystream: 0},
                {x: 5.501516, y: 7.685041, z: 23.815778, step: 530, phase: "warmup", keystream: 0},
                {x: 5.719869, y: 7.838386, z: 23.603484, step: 531, phase: "warmup", keystream: 0},
                {x: 5.931720, y: 8.011477, z: 23.422404, step: 532, phase: "warmup", keystream: 0},
                {x: 6.139696, y: 8.202892, z: 23.273024, step: 533, phase: "warmup", keystream: 0},
                {x: 6.346016, y: 8.411085, z: 23.156043, step: 534, phase: "warmup", keystream: 0},
                {x: 6.552523, y: 8.634373, z: 23.072317, step: 535, phase: "warmup", keystream: 0},
                {x: 6.760708, y: 8.870917, z: 23.022825, step: 536, phase: "warmup", keystream: 0},
                {x: 6.971729, y: 9.118700, z: 23.008620, step: 537, phase: "warmup", keystream: 0},
                {x: 7.186426, y: 9.375498, z: 23.030787, step: 538, phase: "warmup", keystream: 0},
                {x: 7.405333, y: 9.638852, z: 23.090396, step: 539, phase: "warmup", keystream: 0},
                {x: 7.628685, y: 9.906036, z: 23.188441, step: 540, phase: "warmup", keystream: 0},
                {x: 7.856420, y: 10.174034, z: 23.325783, step: 541, phase: "warmup", keystream: 0},
                {x: 8.088181, y: 10.439520, z: 23.503077, step: 542, phase: "warmup", keystream: 0},
                {x: 8.323315, y: 10.698844, z: 23.720696, step: 543, phase: "warmup", keystream: 0},
                {x: 8.560868, y: 10.948036, z: 23.978642, step: 544, phase: "warmup", keystream: 0},
                {x: 8.799585, y: 11.182818, z: 24.276459, step: 545, phase: "warmup", keystream: 0},
                {x: 9.037908, y: 11.398646, z: 24.613128, step: 546, phase: "warmup", keystream: 0},
                {x: 9.273982, y: 11.590762, z: 24.986977, step: 547, phase: "warmup", keystream: 0},
                {x: 9.505660, y: 11.754282, z: 25.395583, step: 548, phase: "warmup", keystream: 0},
                {x: 9.730522, y: 11.884306, z: 25.835690, step: 549, phase: "warmup", keystream: 0},
                {x: 9.945901, y: 11.976062, z: 26.303143, step: 550, phase: "warmup", keystream: 0},
                {x: 10.148917, y: 12.025069, z: 26.792853, step: 551, phase: "warmup", keystream: 0},
                {x: 10.336532, y: 12.027330, z: 27.298791, step: 552, phase: "warmup", keystream: 0},
                {x: 10.505612, y: 11.979538, z: 27.814032, step: 553, phase: "warmup", keystream: 0},
                {x: 10.653004, y: 11.879279, z: 28.330848, step: 554, phase: "warmup", keystream: 0},
                {x: 10.775632, y: 11.725241, z: 28.840859, step: 555, phase: "warmup", keystream: 0},
                {x: 10.870593, y: 11.517381, z: 29.335238, step: 556, phase: "warmup", keystream: 0},
                {x: 10.935272, y: 11.257059, z: 29.804973, step: 557, phase: "warmup", keystream: 0},
                {x: 10.967450, y: 10.947110, z: 30.241164, step: 558, phase: "warmup", keystream: 0},
                {x: 10.965416, y: 10.591840, z: 30.635351, step: 559, phase: "warmup", keystream: 0},
                {x: 10.928059, y: 10.196944, z: 30.979848, step: 560, phase: "warmup", keystream: 0},
                {x: 10.854947, y: 9.769335, z: 31.268047, step: 561, phase: "warmup", keystream: 0},
                {x: 10.746386, y: 9.316897, z: 31.494688, step: 562, phase: "warmup", keystream: 0},
                {x: 10.603437, y: 8.848176, z: 31.656060, step: 563, phase: "warmup", keystream: 0},
                {x: 10.427911, y: 8.372026, z: 31.750109, step: 564, phase: "warmup", keystream: 0},
                {x: 10.222322, y: 7.897247, z: 31.776467, step: 565, phase: "warmup", keystream: 0},
                {x: 9.989815, y: 7.432232, z: 31.736376, step: 566, phase: "warmup", keystream: 0},
                {x: 9.734057, y: 6.984653, z: 31.632539, step: 567, phase: "warmup", keystream: 0},
                {x: 9.459116, y: 6.561213, z: 31.468895, step: 568, phase: "warmup", keystream: 0},
                {x: 9.169326, y: 6.167474, z: 31.250357, step: 569, phase: "warmup", keystream: 0},
                {x: 8.869141, y: 5.807763, z: 30.982530, step: 570, phase: "warmup", keystream: 0},
                {x: 8.563003, y: 5.485161, z: 30.671428, step: 571, phase: "warmup", keystream: 0},
                {x: 8.255219, y: 5.201555, z: 30.323218, step: 572, phase: "warmup", keystream: 0},
                {x: 7.949852, y: 4.957753, z: 29.943999, step: 573, phase: "warmup", keystream: 0},
                {x: 7.650642, y: 4.753630, z: 29.539626, step: 574, phase: "warmup", keystream: 0},
                {x: 7.360941, y: 4.588303, z: 29.115586, step: 575, phase: "warmup", keystream: 0},
                {x: 7.083677, y: 4.460302, z: 28.676912, step: 576, phase: "warmup", keystream: 0},
                {x: 6.821340, y: 4.367749, z: 28.228148, step: 577, phase: "warmup", keystream: 0},
                {x: 6.575981, y: 4.308508, z: 27.773337, step: 578, phase: "warmup", keystream: 0},
                {x: 6.349233, y: 4.280329, z: 27.316041, step: 579, phase: "warmup", keystream: 0},
                {x: 6.142343, y: 4.280952, z: 26.859381, step: 580, phase: "warmup", keystream: 0},
                {x: 5.956204, y: 4.308203, z: 26.406082, step: 581, phase: "warmup", keystream: 0},
                {x: 5.791404, y: 4.360058, z: 25.958525, step: 582, phase: "warmup", keystream: 0},
                {x: 5.648269, y: 4.434687, z: 25.518806, step: 583, phase: "warmup", keystream: 0},
                {x: 5.526911, y: 4.530485, z: 25.088788, step: 584, phase: "warmup", keystream: 0},
                {x: 5.427268, y: 4.646080, z: 24.670149, step: 585, phase: "warmup", keystream: 0},
                {x: 5.349150, y: 4.780339, z: 24.264434, step: 586, phase: "warmup", keystream: 0},
                {x: 5.292268, y: 4.932357, z: 23.873090, step: 587, phase: "warmup", keystream: 0},
                {x: 5.256277, y: 5.101440, z: 23.497508, step: 588, phase: "warmup", keystream: 0},
                {x: 5.240794, y: 5.287090, z: 23.139053, step: 589, phase: "warmup", keystream: 0},
                {x: 5.245423, y: 5.488971, z: 22.799097, step: 590, phase: "warmup", keystream: 0},
                {x: 5.269778, y: 5.706890, z: 22.479041, step: 591, phase: "warmup", keystream: 0},
                {x: 5.313489, y: 5.940764, z: 22.180340, step: 592, phase: "warmup", keystream: 0},
                {x: 5.376217, y: 6.190583, z: 21.904527, step: 593, phase: "warmup", keystream: 0},
                {x: 5.457653, y: 6.456383, z: 21.653225, step: 594, phase: "warmup", keystream: 0},
                {x: 5.557526, y: 6.738204, z: 21.428173, step: 595, phase: "warmup", keystream: 0},
                {x: 5.675594, y: 7.036053, z: 21.231232, step: 596, phase: "warmup", keystream: 0},
                {x: 5.811640, y: 7.349861, z: 21.064404, step: 597, phase: "warmup", keystream: 0},
                {x: 5.965462, y: 7.679434, z: 20.929834, step: 598, phase: "warmup", keystream: 0},
                {x: 6.136859, y: 8.024408, z: 20.829819, step: 599, phase: "warmup", keystream: 0},
                {x: 6.325614, y: 8.384188, z: 20.766803, step: 600, phase: "warmup", keystream: 0},
                {x: 6.531471, y: 8.757890, z: 20.743373, step: 601, phase: "warmup", keystream: 0},
                {x: 6.754113, y: 9.144275, z: 20.762236, step: 602, phase: "warmup", keystream: 0},
                {x: 6.993129, y: 9.541679, z: 20.826191, step: 603, phase: "warmup", keystream: 0},
                {x: 7.247984, y: 9.947936, z: 20.938088, step: 604, phase: "warmup", keystream: 0},
                {x: 7.517980, y: 10.360303, z: 21.100764, step: 605, phase: "warmup", keystream: 0},
                {x: 7.802212, y: 10.775383, z: 21.316962, step: 606, phase: "warmup", keystream: 0},
                {x: 8.099529, y: 11.189054, z: 21.589228, step: 607, phase: "warmup", keystream: 0},
                {x: 8.408482, y: 11.596406, z: 21.919776, step: 608, phase: "warmup", keystream: 0},
                {x: 8.727274, y: 11.991697, z: 22.310330, step: 609, phase: "warmup", keystream: 0},
                {x: 9.053716, y: 12.368333, z: 22.761936, step: 610, phase: "warmup", keystream: 0},
                {x: 9.385178, y: 12.718889, z: 23.274745, step: 611, phase: "warmup", keystream: 0},
                {x: 9.718549, y: 13.035173, z: 23.847776, step: 612, phase: "warmup", keystream: 0},
                {x: 10.050212, y: 13.308358, z: 24.478665, step: 613, phase: "warmup", keystream: 0},
                {x: 10.376026, y: 13.529176, z: 25.163419, step: 614, phase: "warmup", keystream: 0},
                {x: 10.691341, y: 13.688208, z: 25.896185, step: 615, phase: "warmup", keystream: 0},
                {x: 10.991028, y: 13.776252, z: 26.669073, step: 616, phase: "warmup", keystream: 0},
                {x: 11.269550, y: 13.784772, z: 27.472049, step: 617, phase: "warmup", keystream: 0},
                {x: 11.521073, y: 13.706422, z: 28.292943, step: 618, phase: "warmup", keystream: 0},
                {x: 11.739607, y: 13.535608, z: 29.117592, step: 619, phase: "warmup", keystream: 0},
                {x: 11.919208, y: 13.269051, z: 29.930150, step: 620, phase: "warmup", keystream: 0},
                {x: 12.054192, y: 12.906302, z: 30.713578, step: 621, phase: "warmup", keystream: 0},
                {x: 12.139403, y: 12.450139, z: 31.450300, step: 622, phase: "warmup", keystream: 0},
                {x: 12.170476, y: 11.906792, z: 32.122998, step: 623, phase: "warmup", keystream: 0},
                {x: 12.144108, y: 11.285935, z: 32.715498, step: 624, phase: "warmup", keystream: 0},
                {x: 12.058291, y: 10.600421, z: 33.213661, step: 625, phase: "warmup", keystream: 0},
                {x: 11.912504, y: 9.865738, z: 33.606193, step: 626, phase: "warmup", keystream: 0},
                {x: 11.707827, y: 9.099243, z: 33.885284, step: 627, phase: "warmup", keystream: 0},
                {x: 11.446969, y: 8.319212, z: 34.047000, step: 628, phase: "warmup", keystream: 0},
                {x: 11.134193, y: 7.543821, z: 34.091378, step: 629, phase: "warmup", keystream: 0},
                {x: 10.775156, y: 6.790157, z: 34.022218, step: 630, phase: "warmup", keystream: 0},
                {x: 10.376656, y: 6.073353, z: 33.846609, step: 631, phase: "warmup", keystream: 0},
                {x: 9.946326, y: 5.405937, z: 33.574243, step: 632, phase: "warmup", keystream: 0},
                {x: 9.492287, y: 4.797445, z: 33.216622, step: 633, phase: "warmup", keystream: 0},
                {x: 9.022803, y: 4.254294, z: 32.786233, step: 634, phase: "warmup", keystream: 0},
                {x: 8.545952, y: 3.779898, z: 32.295790, step: 635, phase: "warmup", keystream: 0},
                {x: 8.069346, y: 3.374983, z: 31.757597, step: 636, phase: "warmup", keystream: 0},
                {x: 7.599910, y: 3.038020, z: 31.183067, step: 637, phase: "warmup", keystream: 0},
                {x: 7.143721, y: 2.765729, z: 30.582405, step: 638, phase: "warmup", keystream: 0},
                {x: 6.705922, y: 2.553592, z: 29.964450, step: 639, phase: "warmup", keystream: 0},
                {x: 6.290689, y: 2.396322, z: 29.336640, step: 640, phase: "warmup", keystream: 0},
                {x: 5.901252, y: 2.288275, z: 28.705075, step: 641, phase: "warmup", keystream: 0},
                {x: 5.539954, y: 2.223784, z: 28.074643, step: 642, phase: "warmup", keystream: 0},
                {x: 5.208337, y: 2.197411, z: 27.449183, step: 643, phase: "warmup", keystream: 0},
                {x: 4.907245, y: 2.204125, z: 26.831653, step: 644, phase: "warmup", keystream: 0},
                {x: 4.636933, y: 2.239417, z: 26.224304, step: 645, phase: "warmup", keystream: 0},
                {x: 4.397181, y: 2.299361, z: 25.628830, step: 646, phase: "warmup", keystream: 0},
                {x: 4.187399, y: 2.380632, z: 25.046501, step: 647, phase: "warmup", keystream: 0},
                {x: 4.006722, y: 2.480501, z: 24.478281, step: 648, phase: "warmup", keystream: 0},
                {x: 3.854100, y: 2.596801, z: 23.924914, step: 649, phase: "warmup", keystream: 0},
                {x: 3.728370, y: 2.727891, z: 23.386999, step: 650, phase: "warmup", keystream: 0},
                {x: 3.628322, y: 2.872602, z: 22.865052, step: 651, phase: "warmup", keystream: 0},
                {x: 3.552750, y: 3.030188, z: 22.359544, step: 652, phase: "warmup", keystream: 0},
                {x: 3.500494, y: 3.200278, z: 21.870945, step: 653, phase: "warmup", keystream: 0},
                {x: 3.470472, y: 3.382822, z: 21.399745, step: 654, phase: "warmup", keystream: 0},
                {x: 3.461707, y: 3.578054, z: 20.946485, step: 655, phase: "warmup", keystream: 0},
                {x: 3.473342, y: 3.786445, z: 20.511774, step: 656, phase: "warmup", keystream: 0},
                {x: 3.504652, y: 4.008673, z: 20.096310, step: 657, phase: "warmup", keystream: 0},
                {x: 3.555054, y: 4.245583, z: 19.700898, step: 658, phase: "warmup", keystream: 0},
                {x: 3.624107, y: 4.498165, z: 19.326474, step: 659, phase: "warmup", keystream: 0},
                {x: 3.711513, y: 4.767521, z: 18.974119, step: 660, phase: "warmup", keystream: 0},
                {x: 3.817114, y: 5.054842, z: 18.645090, step: 661, phase: "warmup", keystream: 0},
                {x: 3.940887, y: 5.361381, z: 18.340837, step: 662, phase: "warmup", keystream: 0},
                {x: 4.082936, y: 5.688424, z: 18.063034, step: 663, phase: "warmup", keystream: 0},
                {x: 4.243485, y: 6.037260, z: 17.813607, step: 664, phase: "warmup", keystream: 0},
                {x: 4.422862, y: 6.409146, z: 17.594768, step: 665, phase: "warmup", keystream: 0},
                {x: 4.621491, y: 6.805263, z: 17.409042, step: 666, phase: "warmup", keystream: 0},
                {x: 4.839868, y: 7.226671, z: 17.259306, step: 667, phase: "warmup", keystream: 0},
                {x: 5.078548, y: 7.674239, z: 17.148819, step: 668, phase: "warmup", keystream: 0},
                {x: 5.338117, y: 8.148579, z: 17.081257, step: 669, phase: "warmup", keystream: 0},
                {x: 5.619164, y: 8.649949, z: 17.060737, step: 670, phase: "warmup", keystream: 0},
                {x: 5.922242, y: 9.178145, z: 17.091839, step: 671, phase: "warmup", keystream: 0},
                {x: 6.247832, y: 9.732371, z: 17.179609, step: 672, phase: "warmup", keystream: 0},
                {x: 6.596286, y: 10.311087, z: 17.329548, step: 673, phase: "warmup", keystream: 0},
                {x: 6.967766, y: 10.911830, z: 17.547576, step: 674, phase: "warmup", keystream: 0},
                {x: 7.362173, y: 11.531012, z: 17.839951, step: 675, phase: "warmup", keystream: 0},
                {x: 7.779057, y: 12.163702, z: 18.213152, step: 676, phase: "warmup", keystream: 0},
                {x: 8.217521, y: 12.803390, z: 18.673689, step: 677, phase: "warmup", keystream: 0},
                {x: 8.676108, y: 13.441747, z: 19.227845, step: 678, phase: "warmup", keystream: 0},
                {x: 9.152672, y: 14.068411, z: 19.881323, step: 679, phase: "warmup", keystream: 0},
                {x: 9.644246, y: 14.670803, z: 20.638790, step: 680, phase: "warmup", keystream: 0},
                {x: 10.146902, y: 15.234028, z: 21.503311, step: 681, phase: "warmup", keystream: 0},
                {x: 10.655614, y: 15.740901, z: 22.475671, step: 682, phase: "warmup", keystream: 0},
                {x: 11.164143, y: 16.172143, z: 23.553610, step: 683, phase: "warmup", keystream: 0},
                {x: 11.664943, y: 16.506823, z: 24.730994, step: 684, phase: "warmup", keystream: 0},
                {x: 12.149131, y: 16.723082, z: 25.997013, step: 685, phase: "warmup", keystream: 0},
                {x: 12.606526, y: 16.799197, z: 27.335468, step: 686, phase: "warmup", keystream: 0},
                {x: 13.025793, y: 16.714979, z: 28.724317, step: 687, phase: "warmup", keystream: 0},
                {x: 13.394712, y: 16.453481, z: 30.135594, step: 688, phase: "warmup", keystream: 0},
                {x: 13.700589, y: 16.002890, z: 31.535875, step: 689, phase: "warmup", keystream: 0},
                {x: 13.930819, y: 15.358425, z: 32.887408, step: 690, phase: "warmup", keystream: 0},
                {x: 14.073579, y: 14.523985, z: 34.149965, step: 691, phase: "warmup", keystream: 0},
                {x: 14.118620, y: 13.513225, z: 35.283344, step: 692, phase: "warmup", keystream: 0},
                {x: 14.058081, y: 12.349785, z: 36.250336, step: 693, phase: "warmup", keystream: 0},
                {x: 13.887251, y: 11.066448, z: 37.019803, step: 694, phase: "warmup", keystream: 0},
                {x: 13.605171, y: 9.703181, z: 37.569434, step: 695, phase: "warmup", keystream: 0},
                {x: 13.214972, y: 8.304212, z: 37.887716, step: 696, phase: "warmup", keystream: 0},
                {x: 12.723896, y: 6.914511, z: 37.974776, step: 697, phase: "warmup", keystream: 0},
                {x: 12.142957, y: 5.576185, z: 37.841911, step: 698, phase: "warmup", keystream: 0},
                {x: 11.486280, y: 4.325325, z: 37.509907, step: 699, phase: "warmup", keystream: 0},
                {x: 10.770185, y: 3.189737, z: 37.006462, step: 700, phase: "warmup", keystream: 0},
                {x: 10.012140, y: 2.187827, z: 36.363163, step: 701, phase: "warmup", keystream: 0},
                {x: 9.229708, y: 1.328617, z: 35.612527, step: 702, phase: "warmup", keystream: 0},
                {x: 8.439599, y: 0.612717, z: 34.785487, step: 703, phase: "warmup", keystream: 0},
                {x: 7.656911, y: 0.033922, z: 33.909585, step: 704, phase: "warmup", keystream: 0},
                {x: 6.894612, y: -0.418909, z: 33.007927, step: 705, phase: "warmup", keystream: 0},
                {x: 6.163260, y: -0.759997, z: 32.098833, step: 706, phase: "warmup", keystream: 0},
                {x: 5.470934, y: -1.005019, z: 31.196024, step: 707, phase: "warmup", keystream: 0},
                {x: 4.823339, y: -1.169821, z: 30.309146, step: 708, phase: "warmup", keystream: 0},
                {x: 4.224023, y: -1.269501, z: 29.444478, step: 709, phase: "warmup", keystream: 0},
                {x: 3.674670, y: -1.317821, z: 28.605668, step: 710, phase: "warmup", keystream: 0},
                {x: 3.175421, y: -1.326899, z: 27.794424, step: 711, phase: "warmup", keystream: 0},
                {x: 2.725189, y: -1.307102, z: 27.011105, step: 712, phase: "warmup", keystream: 0},
                {x: 2.321960, y: -1.267082, z: 26.255188, step: 713, phase: "warmup", keystream: 0},
                {x: 1.963056, y: -1.213897, z: 25.525628, step: 714, phase: "warmup", keystream: 0},
                {x: 1.645361, y: -1.153185, z: 24.821115, step: 715, phase: "warmup", keystream: 0},
                {x: 1.365506, y: -1.089349, z: 24.140245, step: 716, phase: "warmup", keystream: 0},
                {x: 1.120021, y: -1.025750, z: 23.481630, step: 717, phase: "warmup", keystream: 0},
                {x: 0.905443, y: -0.964886, z: 22.843964, step: 718, phase: "warmup", keystream: 0},
                {x: 0.718410, y: -0.908552, z: 22.226056, step: 719, phase: "warmup", keystream: 0},
                {x: 0.555714, y: -0.857986, z: 21.626834, step: 720, phase: "warmup", keystream: 0},
                {x: 0.414344, y: -0.813990, z: 21.045350, step: 721, phase: "warmup", keystream: 0},
                {x: 0.291511, y: -0.777034, z: 20.480768, step: 722, phase: "warmup", keystream: 0},
                {x: 0.184656, y: -0.747344, z: 19.932349, step: 723, phase: "warmup", keystream: 0},
                {x: 0.091456, y: -0.724973, z: 19.399440, step: 724, phase: "warmup", keystream: 0},
                {x: 0.009813, y: -0.709858, z: 18.881458, step: 725, phase: "warmup", keystream: 0},
                {x: -0.062154, y: -0.701864, z: 18.377883, step: 726, phase: "warmup", keystream: 0},
                {x: -0.126125, y: -0.700826, z: 17.888242, step: 727, phase: "warmup", keystream: 0},
                {x: -0.183595, y: -0.706571, z: 17.412107, step: 728, phase: "warmup", keystream: 0},
                {x: -0.235893, y: -0.718944, z: 16.949081, step: 729, phase: "warmup", keystream: 0},
                {x: -0.284198, y: -0.737823, z: 16.498801, step: 730, phase: "warmup", keystream: 0},
                {x: -0.329560, y: -0.763131, z: 16.060930, step: 731, phase: "warmup", keystream: 0},
                {x: -0.372917, y: -0.794846, z: 15.635154, step: 732, phase: "warmup", keystream: 0},
                {x: -0.415110, y: -0.833008, z: 15.221180, step: 733, phase: "warmup", keystream: 0},
                {x: -0.456900, y: -0.877725, z: 14.818740, step: 734, phase: "warmup", keystream: 0},
                {x: -0.498983, y: -0.929173, z: 14.427584, step: 735, phase: "warmup", keystream: 0},
                {x: -0.542002, y: -0.987605, z: 14.047485, step: 736, phase: "warmup", keystream: 0},
                {x: -0.586562, y: -1.053352, z: 13.678238, step: 737, phase: "warmup", keystream: 0},
                {x: -0.633241, y: -1.126824, z: 13.319664, step: 738, phase: "warmup", keystream: 0},
                {x: -0.682599, y: -1.208518, z: 12.971608, step: 739, phase: "warmup", keystream: 0},
                {x: -0.735191, y: -1.299016, z: 12.633948, step: 740, phase: "warmup", keystream: 0},
                {x: -0.791574, y: -1.398996, z: 12.306593, step: 741, phase: "warmup", keystream: 0},
                {x: -0.852316, y: -1.509231, z: 11.989491, step: 742, phase: "warmup", keystream: 0},
                {x: -0.918007, y: -1.630599, z: 11.682635, step: 743, phase: "warmup", keystream: 0},
                {x: -0.989266, y: -1.764087, z: 11.386067, step: 744, phase: "warmup", keystream: 0},
                {x: -1.066748, y: -1.910802, z: 11.099890, step: 745, phase: "warmup", keystream: 0},
                {x: -1.151154, y: -2.071976, z: 10.824276, step: 746, phase: "warmup", keystream: 0},
                {x: -1.243236, y: -2.248975, z: 10.559481, step: 747, phase: "warmup", keystream: 0},
                {x: -1.343810, y: -2.443312, z: 10.305855, step: 748, phase: "warmup", keystream: 0},
                {x: -1.453760, y: -2.656655, z: 10.063865, step: 749, phase: "warmup", keystream: 0},
                {x: -1.574050, y: -2.890837, z: 9.834117, step: 750, phase: "warmup", keystream: 0},
                {x: -1.705728, y: -3.147868, z: 9.617377, step: 751, phase: "warmup", keystream: 0},
                {x: -1.849942, y: -3.429947, z: 9.414608, step: 752, phase: "warmup", keystream: 0},
                {x: -2.007943, y: -3.739467, z: 9.227004, step: 753, phase: "warmup", keystream: 0},
                {x: -2.181095, y: -4.079023, z: 9.056036, step: 754, phase: "warmup", keystream: 0},
                {x: -2.370888, y: -4.451419, z: 8.903510, step: 755, phase: "warmup", keystream: 0},
                {x: -2.578941, y: -4.859661, z: 8.771621, step: 756, phase: "warmup", keystream: 0},
                {x: -2.807013, y: -5.306953, z: 8.663039, step: 757, phase: "warmup", keystream: 0},
                {x: -3.057007, y: -5.796675, z: 8.580991, step: 758, phase: "warmup", keystream: 0},
                {x: -3.330974, y: -6.332348, z: 8.529370, step: 759, phase: "warmup", keystream: 0},
                {x: -3.631111, y: -6.917586, z: 8.512849, step: 760, phase: "warmup", keystream: 0},
                {x: -3.959759, y: -7.556011, z: 8.537025, step: 761, phase: "warmup", keystream: 0},
                {x: -4.319384, y: -8.251138, z: 8.608570, step: 762, phase: "warmup", keystream: 0},
                {x: -4.712559, y: -9.006216, z: 8.735407, step: 763, phase: "warmup", keystream: 0},
                {x: -5.141925, y: -9.824010, z: 8.926886, step: 764, phase: "warmup", keystream: 0},
                {x: -5.610134, y: -10.706495, z: 9.193979, step: 765, phase: "warmup", keystream: 0},
                {x: -6.119770, y: -11.654473, z: 9.549455, step: 766, phase: "warmup", keystream: 0},
                {x: -6.673240, y: -12.667059, z: 10.008029, step: 767, phase: "warmup", keystream: 0},
                {x: -7.272622, y: -13.741036, z: 10.586452, step: 768, phase: "warmup", keystream: 0},
                {x: -7.919463, y: -14.870047, z: 11.303480, step: 769, phase: "warmup", keystream: 0},
                {x: -8.614522, y: -16.043621, z: 12.179682, step: 770, phase: "warmup", keystream: 0},
                {x: -9.357432, y: -17.246030, z: 13.236972, step: 771, phase: "warmup", keystream: 0},
                {x: -10.146291, y: -18.455010, z: 14.497771, step: 772, phase: "warmup", keystream: 0},
                {x: -10.977163, y: -19.640435, z: 15.983663, step: 773, phase: "warmup", keystream: 0},
                {x: -11.843490, y: -20.763084, z: 17.713395, step: 774, phase: "warmup", keystream: 0},
                {x: -12.735450, y: -21.773746, z: 19.700111, step: 775, phase: "warmup", keystream: 0},
                {x: -13.639279, y: -22.613037, z: 21.947759, step: 776, phase: "warmup", keystream: 0},
                {x: -14.536655, y: -23.212388, z: 24.446741, step: 777, phase: "warmup", keystream: 0},
                {x: -15.404228, y: -23.496789, z: 27.169133, step: 778, phase: "warmup", keystream: 0},
                {x: -16.213485, y: -23.389810, z: 30.064122, step: 779, phase: "warmup", keystream: 0},
                {x: -16.931117, y: -22.821246, z: 33.054715, step: 780, phase: "warmup", keystream: 0},
                {x: -17.520130, y: -21.737214, z: 36.037148, step: 781, phase: "warmup", keystream: 0},
                {x: -17.941838, y: -20.111723, z: 38.884545, step: 782, phase: "warmup", keystream: 0},
                {x: -18.158827, y: -17.957718, z: 41.456037, step: 783, phase: "warmup", keystream: 0},
                {x: -18.138716, y: -15.334683, z: 43.611454, step: 784, phase: "warmup", keystream: 0},
                {x: -17.858313, y: -12.349619, z: 45.229996, step: 785, phase: "warmup", keystream: 0},
                {x: -17.307443, y: -9.149136, z: 46.229296, step: 786, phase: "warmup", keystream: 0},
                {x: -16.491612, y: -5.902619, z: 46.579997, step: 787, phase: "warmup", keystream: 0},
                {x: -15.432713, y: -2.779452, z: 46.311300, step: 788, phase: "warmup", keystream: 0},
                {x: -14.167387, y: 0.074273, z: 45.505277, step: 789, phase: "warmup", keystream: 0},
                {x: -12.743221, y: 2.553571, z: 44.281281, step: 790, phase: "warmup", keystream: 0},
                {x: -11.213542, y: 4.602794, z: 42.775039, step: 791, phase: "warmup", keystream: 0},
                {x: -9.631908, y: 6.213572, z: 41.118235, step: 792, phase: "warmup", keystream: 0},
                {x: -8.047360, y: 7.414972, z: 39.423264, step: 793, phase: "warmup", keystream: 0},
                {x: -6.501127, y: 8.260094, z: 37.775267, step: 794, phase: "warmup", keystream: 0},
                {x: -5.025005, y: 8.812995, z: 36.230927, step: 795, phase: "warmup", keystream: 0},
                {x: -3.641205, y: 9.138470, z: 34.821916, step: 796, phase: "warmup", keystream: 0},
                {x: -2.363237, y: 9.295485, z: 33.560581, step: 797, phase: "warmup", keystream: 0},
                {x: -1.197365, y: 9.333940, z: 32.445958, step: 798, phase: "warmup", keystream: 0},
                {x: -0.144235, y: 9.293835, z: 31.468971, step: 799, phase: "warmup", keystream: 0},
                {x: 0.799572, y: 9.205900, z: 30.616393, step: 800, phase: "warmup", keystream: 0},
                {x: 1.640205, y: 9.092921, z: 29.873564, step: 801, phase: "warmup", keystream: 0},
                {x: 2.385477, y: 8.971262, z: 29.226078, step: 802, phase: "warmup", keystream: 0},
                {x: 3.044055, y: 8.852301, z: 28.660724, step: 803, phase: "warmup", keystream: 0},
                {x: 3.624880, y: 8.743665, z: 28.165907, step: 804, phase: "warmup", keystream: 0},
                {x: 4.136758, y: 8.650215, z: 27.731763, step: 805, phase: "warmup", keystream: 0},
                {x: 4.588104, y: 8.574809, z: 27.350088, step: 806, phase: "warmup", keystream: 0},
                {x: 4.986775, y: 8.518880, z: 27.014173, step: 807, phase: "warmup", keystream: 0},
                {x: 5.339985, y: 8.482852, z: 26.718613, step: 808, phase: "warmup", keystream: 0},
                {x: 5.654272, y: 8.466449, z: 26.459099, step: 809, phase: "warmup", keystream: 0},
                {x: 5.935489, y: 8.468911, z: 26.232239, step: 810, phase: "warmup", keystream: 0},
                {x: 6.188832, y: 8.489147, z: 26.035384, step: 811, phase: "warmup", keystream: 0},
                {x: 6.418863, y: 8.525843, z: 25.866487, step: 812, phase: "warmup", keystream: 0},
                {x: 6.629561, y: 8.577532, z: 25.723976, step: 813, phase: "warmup", keystream: 0},
                {x: 6.824358, y: 8.642647, z: 25.606656, step: 814, phase: "warmup", keystream: 0},
                {x: 7.006187, y: 8.719551, z: 25.513617, step: 815, phase: "warmup", keystream: 0},
                {x: 7.177523, y: 8.806556, z: 25.444162, step: 816, phase: "warmup", keystream: 0},
                {x: 7.340427, y: 8.901936, z: 25.397743, step: 817, phase: "warmup", keystream: 0},
                {x: 7.496578, y: 9.003934, z: 25.373910, step: 818, phase: "warmup", keystream: 0},
                {x: 7.647313, y: 9.110761, z: 25.372260, step: 819, phase: "warmup", keystream: 0},
                {x: 7.793658, y: 9.220605, z: 25.392394, step: 820, phase: "warmup", keystream: 0},
                {x: 7.936353, y: 9.331627, z: 25.433886, step: 821, phase: "warmup", keystream: 0},
                {x: 8.075880, y: 9.441966, z: 25.496240, step: 822, phase: "warmup", keystream: 0},
                {x: 8.212489, y: 9.549747, z: 25.578862, step: 823, phase: "warmup", keystream: 0},
                {x: 8.346215, y: 9.653086, z: 25.681031, step: 824, phase: "warmup", keystream: 0},
                {x: 8.476902, y: 9.750101, z: 25.801871, step: 825, phase: "warmup", keystream: 0},
                {x: 8.604222, y: 9.838933, z: 25.940328, step: 826, phase: "warmup", keystream: 0},
                {x: 8.727693, y: 9.917762, z: 26.095149, step: 827, phase: "warmup", keystream: 0},
                {x: 8.846700, y: 9.984834, z: 26.264870, step: 828, phase: "warmup", keystream: 0},
                {x: 8.960513, y: 10.038488, z: 26.447802, step: 829, phase: "warmup", keystream: 0},
                {x: 9.068311, y: 10.077188, z: 26.642027, step: 830, phase: "warmup", keystream: 0},
                {x: 9.169198, y: 10.099561, z: 26.845404, step: 831, phase: "warmup", keystream: 0},
                {x: 9.262235, y: 10.104433, z: 27.055575, step: 832, phase: "warmup", keystream: 0},
                {x: 9.346454, y: 10.090863, z: 27.269990, step: 833, phase: "warmup", keystream: 0},
                {x: 9.420895, y: 10.058185, z: 27.485928, step: 834, phase: "warmup", keystream: 0},
                {x: 9.484624, y: 10.006033, z: 27.700541, step: 835, phase: "warmup", keystream: 0},
                {x: 9.536765, y: 9.934375, z: 27.910894, step: 836, phase: "warmup", keystream: 0},
                {x: 9.576526, y: 9.843529, z: 28.114022, step: 837, phase: "warmup", keystream: 0},
                {x: 9.603226, y: 9.734175, z: 28.306983, step: 838, phase: "warmup", keystream: 0},
                {x: 9.616321, y: 9.607353, z: 28.486925, step: 839, phase: "warmup", keystream: 0},
                {x: 9.615424, y: 9.464455, z: 28.651147, step: 840, phase: "warmup", keystream: 0},
                {x: 9.600327, y: 9.307200, z: 28.797164, step: 841, phase: "warmup", keystream: 0},
                {x: 9.571015, y: 9.137597, z: 28.922761, step: 842, phase: "warmup", keystream: 0},
                {x: 9.527673, y: 8.957904, z: 29.026049, step: 843, phase: "warmup", keystream: 0},
                {x: 9.470696, y: 8.770566, z: 29.105500, step: 844, phase: "warmup", keystream: 0},
                {x: 9.400683, y: 8.578162, z: 29.159987, step: 845, phase: "warmup", keystream: 0},
                {x: 9.318431, y: 8.383334, z: 29.188794, step: 846, phase: "warmup", keystream: 0},
                {x: 9.224921, y: 8.188723, z: 29.191621, step: 847, phase: "warmup", keystream: 0},
                {x: 9.121301, y: 7.996910, z: 29.168581, step: 848, phase: "warmup", keystream: 0},
                {x: 9.008862, y: 7.810351, z: 29.120174, step: 849, phase: "warmup", keystream: 0},
                {x: 8.889011, y: 7.631333, z: 29.047260, step: 850, phase: "warmup", keystream: 0},
                {x: 8.763243, y: 7.461928, z: 28.951017, step: 851, phase: "warmup", keystream: 0},
                {x: 8.633112, y: 7.303969, z: 28.832896, step: 852, phase: "warmup", keystream: 0},
                {x: 8.500198, y: 7.159025, z: 28.694579, step: 853, phase: "warmup", keystream: 0},
                {x: 8.366080, y: 7.028394, z: 28.537922, step: 854, phase: "warmup", keystream: 0},
                {x: 8.232312, y: 6.913107, z: 28.364911, step: 855, phase: "warmup", keystream: 0},
                {x: 8.100391, y: 6.813935, z: 28.177622, step: 856, phase: "warmup", keystream: 0},
                {x: 7.971746, y: 6.731408, z: 27.978174, step: 857, phase: "warmup", keystream: 0},
                {x: 7.847712, y: 6.665833, z: 27.768700, step: 858, phase: "warmup", keystream: 0},
                {x: 7.729524, y: 6.617327, z: 27.551317, step: 859, phase: "warmup", keystream: 0},
                {x: 7.618304, y: 6.585835, z: 27.328103, step: 860, phase: "warmup", keystream: 0},
                {x: 7.515057, y: 6.571163, z: 27.101083, step: 861, phase: "warmup", keystream: 0},
                {x: 7.420668, y: 6.573006, z: 26.872214, step: 862, phase: "warmup", keystream: 0},
                {x: 7.335902, y: 6.590965, z: 26.643382, step: 863, phase: "warmup", keystream: 0},
                {x: 7.261408, y: 6.624576, z: 26.416399, step: 864, phase: "warmup", keystream: 0},
                {x: 7.197725, y: 6.673322, z: 26.192999, step: 865, phase: "warmup", keystream: 0},
                {x: 7.145284, y: 6.736651, z: 25.974846, step: 866, phase: "warmup", keystream: 0},
                {x: 7.104421, y: 6.813988, z: 25.763537, step: 867, phase: "warmup", keystream: 0},
                {x: 7.075378, y: 6.904736, z: 25.560604, step: 868, phase: "warmup", keystream: 0},
                {x: 7.058314, y: 7.008285, z: 25.367524, step: 869, phase: "warmup", keystream: 0},
                {x: 7.053311, y: 7.124010, z: 25.185723, step: 870, phase: "warmup", keystream: 0},
                {x: 7.060381, y: 7.251270, z: 25.016582, step: 871, phase: "warmup", keystream: 0},
                {x: 7.079470, y: 7.389398, z: 24.861441, step: 872, phase: "warmup", keystream: 0},
                {x: 7.110463, y: 7.537697, z: 24.721599, step: 873, phase: "warmup", keystream: 0},
                {x: 7.153186, y: 7.695430, z: 24.598322, step: 874, phase: "warmup", keystream: 0},
                {x: 7.207410, y: 7.861804, z: 24.492835, step: 875, phase: "warmup", keystream: 0},
                {x: 7.272850, y: 8.035962, z: 24.406325, step: 876, phase: "warmup", keystream: 0},
                {x: 7.349161, y: 8.216965, z: 24.339933, step: 877, phase: "warmup", keystream: 0},
                {x: 7.435941, y: 8.403779, z: 24.294746, step: 878, phase: "warmup", keystream: 0},
                {x: 7.532725, y: 8.595262, z: 24.271786, step: 879, phase: "warmup", keystream: 0},
                {x: 7.638979, y: 8.790145, z: 24.271996, step: 880, phase: "warmup", keystream: 0},
                {x: 7.754095, y: 8.987025, z: 24.296220, step: 881, phase: "warmup", keystream: 0},
                {x: 7.877388, y: 9.184350, z: 24.345184, step: 882, phase: "warmup", keystream: 0},
                {x: 8.008085, y: 9.380410, z: 24.419466, step: 883, phase: "warmup", keystream: 0},
                {x: 8.145317, y: 9.573338, z: 24.519471, step: 884, phase: "warmup", keystream: 0},
                {x: 8.288119, y: 9.761105, z: 24.645397, step: 885, phase: "warmup", keystream: 0},
                {x: 8.435418, y: 9.941528, z: 24.797199, step: 886, phase: "warmup", keystream: 0},
                {x: 8.586029, y: 10.112282, z: 24.974550, step: 887, phase: "warmup", keystream: 0},
                {x: 8.738654, y: 10.270925, z: 25.176805, step: 888, phase: "warmup", keystream: 0},
                {x: 8.891881, y: 10.414925, z: 25.402964, step: 889, phase: "warmup", keystream: 0},
                {x: 9.044186, y: 10.541701, z: 25.651635, step: 890, phase: "warmup", keystream: 0},
                {x: 9.193937, y: 10.648675, z: 25.921002, step: 891, phase: "warmup", keystream: 0},
                {x: 9.339411, y: 10.733330, z: 26.208808, step: 892, phase: "warmup", keystream: 0},
                {x: 9.478803, y: 10.793283, z: 26.512336, step: 893, phase: "warmup", keystream: 0},
                {x: 9.610251, y: 10.826363, z: 26.828414, step: 894, phase: "warmup", keystream: 0},
                {x: 9.731862, y: 10.830692, z: 27.153431, step: 895, phase: "warmup", keystream: 0},
                {x: 9.841745, y: 10.804772, z: 27.483367, step: 896, phase: "warmup", keystream: 0},
                {x: 9.938048, y: 10.747570, z: 27.813856, step: 897, phase: "warmup", keystream: 0},
                {x: 10.019000, y: 10.658593, z: 28.140251, step: 898, phase: "warmup", keystream: 0},
                {x: 10.082959, y: 10.537956, z: 28.457729, step: 899, phase: "warmup", keystream: 0},
                {x: 10.128459, y: 10.386423, z: 28.761394, step: 900, phase: "warmup", keystream: 0},
                {x: 10.154255, y: 10.205442, z: 29.046408, step: 901, phase: "warmup", keystream: 0},
                {x: 10.159374, y: 9.997132, z: 29.308124, step: 902, phase: "warmup", keystream: 0},
                {x: 10.143150, y: 9.764264, z: 29.542220, step: 903, phase: "warmup", keystream: 0},
                {x: 10.105261, y: 9.510191, z: 29.744831, step: 904, phase: "warmup", keystream: 0},
                {x: 10.045754, y: 9.238770, z: 29.912666, step: 905, phase: "warmup", keystream: 0},
                {x: 9.965056, y: 8.954240, z: 30.043099, step: 906, phase: "warmup", keystream: 0},
                {x: 9.863974, y: 8.661102, z: 30.134244, step: 907, phase: "warmup", keystream: 0},
                {x: 9.743687, y: 8.363970, z: 30.184993, step: 908, phase: "warmup", keystream: 0},
                {x: 9.605715, y: 8.067431, z: 30.195019, step: 909, phase: "warmup", keystream: 0},
                {x: 9.451887, y: 7.775909, z: 30.164753, step: 910, phase: "warmup", keystream: 0},
                {x: 9.284289, y: 7.493540, z: 30.095330, step: 911, phase: "warmup", keystream: 0},
                {x: 9.105214, y: 7.224068, z: 29.988510, step: 912, phase: "warmup", keystream: 0},
                {x: 8.917100, y: 6.970770, z: 29.846583, step: 913, phase: "warmup", keystream: 0},
                {x: 8.722467, y: 6.736400, z: 29.672265, step: 914, phase: "warmup", keystream: 0},
                {x: 8.523860, y: 6.523174, z: 29.468585, step: 915, phase: "warmup", keystream: 0},
                {x: 8.323791, y: 6.332762, z: 29.238782, step: 916, phase: "warmup", keystream: 0},
                {x: 8.124688, y: 6.166320, z: 28.986207, step: 917, phase: "warmup", keystream: 0},
                {x: 7.928852, y: 6.024531, z: 28.714236, step: 918, phase: "warmup", keystream: 0},
                {x: 7.738420, y: 5.907655, z: 28.426199, step: 919, phase: "warmup", keystream: 0},
                {x: 7.555343, y: 5.815597, z: 28.125326, step: 920, phase: "warmup", keystream: 0},
                {x: 7.381369, y: 5.747973, z: 27.814706, step: 921, phase: "warmup", keystream: 0},
                {x: 7.218029, y: 5.704170, z: 27.497259, step: 922, phase: "warmup", keystream: 0},
                {x: 7.066643, y: 5.683416, z: 27.175728, step: 923, phase: "warmup", keystream: 0},
                {x: 6.928320, y: 5.684831, z: 26.852668, step: 924, phase: "warmup", keystream: 0},
                {x: 6.803971, y: 5.707473, z: 26.530460, step: 925, phase: "warmup", keystream: 0},
                {x: 6.694322, y: 5.750385, z: 26.211316, step: 926, phase: "warmup", keystream: 0},
                {x: 6.599928, y: 5.812622, z: 25.897297, step: 927, phase: "warmup", keystream: 0},
                {x: 6.521197, y: 5.893273, z: 25.590332, step: 928, phase: "warmup", keystream: 0},
                {x: 6.458405, y: 5.991479, z: 25.292235, step: 929, phase: "warmup", keystream: 0},
                {x: 6.411712, y: 6.106443, z: 25.004729, step: 930, phase: "warmup", keystream: 0},
                {x: 6.381185, y: 6.237426, z: 24.729464, step: 931, phase: "warmup", keystream: 0},
                {x: 6.366809, y: 6.383751, z: 24.468033, step: 932, phase: "warmup", keystream: 0},
                {x: 6.368504, y: 6.544787, z: 24.221994, step: 933, phase: "warmup", keystream: 0},
                {x: 6.386132, y: 6.719942, z: 23.992879, step: 934, phase: "warmup", keystream: 0},
                {x: 6.419513, y: 6.908642, z: 23.782213, step: 935, phase: "warmup", keystream: 0},
                {x: 6.468426, y: 7.110317, z: 23.591522, step: 936, phase: "warmup", keystream: 0},
                {x: 6.532615, y: 7.324373, z: 23.422340, step: 937, phase: "warmup", keystream: 0},
                {x: 6.611791, y: 7.550171, z: 23.276218, step: 938, phase: "warmup", keystream: 0},
                {x: 6.705629, y: 7.786995, z: 23.154720, step: 939, phase: "warmup", keystream: 0},
                {x: 6.813766, y: 8.034032, z: 23.059428, step: 940, phase: "warmup", keystream: 0},
                {x: 6.935792, y: 8.290331, z: 22.991930, step: 941, phase: "warmup", keystream: 0},
                {x: 7.071246, y: 8.554777, z: 22.953812, step: 942, phase: "warmup", keystream: 0},
                {x: 7.219599, y: 8.826057, z: 22.946639, step: 943, phase: "warmup", keystream: 0},
                {x: 7.380245, y: 9.102629, z: 22.971935, step: 944, phase: "warmup", keystream: 0},
                {x: 7.552483, y: 9.382686, z: 23.031146, step: 945, phase: "warmup", keystream: 0},
                {x: 7.735504, y: 9.664131, z: 23.125608, step: 946, phase: "warmup", keystream: 0},
                {x: 7.928366, y: 9.944549, z: 23.256495, step: 947, phase: "warmup", keystream: 0},
                {x: 8.129985, y: 10.221186, z: 23.424762, step: 948, phase: "warmup", keystream: 0},
                {x: 8.339105, y: 10.490940, z: 23.631082, step: 949, phase: "warmup", keystream: 0},
                {x: 8.554288, y: 10.750359, z: 23.875771, step: 950, phase: "warmup", keystream: 0},
                {x: 8.773895, y: 10.995654, z: 24.158700, step: 951, phase: "warmup", keystream: 0},
                {x: 8.996071, y: 11.222729, z: 24.479215, step: 952, phase: "warmup", keystream: 0},
                {x: 9.218737, y: 11.427234, z: 24.836041, step: 953, phase: "warmup", keystream: 0},
                {x: 9.439587, y: 11.604639, z: 25.227193, step: 954, phase: "warmup", keystream: 0},
                {x: 9.656092, y: 11.750334, z: 25.649898, step: 955, phase: "warmup", keystream: 0},
                {x: 9.865516, y: 11.859759, z: 26.100524, step: 956, phase: "warmup", keystream: 0},
                {x: 10.064941, y: 11.928554, z: 26.574536, step: 957, phase: "warmup", keystream: 0},
                {x: 10.251302, y: 11.952741, z: 27.066484, step: 958, phase: "warmup", keystream: 0},
                {x: 10.421446, y: 11.928911, z: 27.570023, step: 959, phase: "warmup", keystream: 0},
                {x: 10.572192, y: 11.854432, z: 28.077987, step: 960, phase: "warmup", keystream: 0},
                {x: 10.700416, y: 11.727643, z: 28.582514, step: 961, phase: "warmup", keystream: 0},
                {x: 10.803139, y: 11.548035, z: 29.075220, step: 962, phase: "warmup", keystream: 0},
                {x: 10.877628, y: 11.316397, z: 29.547431, step: 963, phase: "warmup", keystream: 0},
                {x: 10.921505, y: 11.034909, z: 29.990455, step: 964, phase: "warmup", keystream: 0},
                {x: 10.932846, y: 10.707172, z: 30.395888, step: 965, phase: "warmup", keystream: 0},
                {x: 10.910278, y: 10.338162, z: 30.755930, step: 966, phase: "warmup", keystream: 0},
                {x: 10.853067, y: 9.934101, z: 31.063694, step: 967, phase: "warmup", keystream: 0},
                {x: 10.761170, y: 9.502255, z: 31.313483, step: 968, phase: "warmup", keystream: 0},
                {x: 10.635279, y: 9.050663, z: 31.501011, step: 969, phase: "warmup", keystream: 0},
                {x: 10.476817, y: 8.587814, z: 31.623547, step: 970, phase: "warmup", keystream: 0},
                {x: 10.287917, y: 8.122303, z: 31.679982, step: 971, phase: "warmup", keystream: 0},
                {x: 10.071355, y: 7.662487, z: 31.670798, step: 972, phase: "warmup", keystream: 0},
                {x: 9.830469, y: 7.216163, z: 31.597960, step: 973, phase: "warmup", keystream: 0},
                {x: 9.569038, y: 6.790305, z: 31.464730, step: 974, phase: "warmup", keystream: 0},
                {x: 9.291165, y: 6.390861, z: 31.275438, step: 975, phase: "warmup", keystream: 0},
                {x: 9.001134, y: 6.022626, z: 31.035211, step: 976, phase: "warmup", keystream: 0},
                {x: 8.703283, y: 5.689196, z: 30.749710, step: 977, phase: "warmup", keystream: 0},
                {x: 8.401875, y: 5.392989, z: 30.424865, step: 978, phase: "warmup", keystream: 0},
                {x: 8.100986, y: 5.135325, z: 30.066647, step: 979, phase: "warmup", keystream: 0},
                {x: 7.804420, y: 4.916553, z: 29.680882, step: 980, phase: "warmup", keystream: 0},
                {x: 7.515633, y: 4.736204, z: 29.273100, step: 981, phase: "warmup", keystream: 0},
                {x: 7.237690, y: 4.593161, z: 28.848440, step: 982, phase: "warmup", keystream: 0},
                {x: 6.973237, y: 4.485822, z: 28.411587, step: 983, phase: "warmup", keystream: 0},
                {x: 6.724496, y: 4.412262, z: 27.966752, step: 984, phase: "warmup", keystream: 0},
                {x: 6.493272, y: 4.370376, z: 27.517674, step: 985, phase: "warmup", keystream: 0},
                {x: 6.280983, y: 4.357991, z: 27.067650, step: 986, phase: "warmup", keystream: 0},
                {x: 6.088684, y: 4.372971, z: 26.619570, step: 987, phase: "warmup", keystream: 0},
                {x: 5.917112, y: 4.413292, z: 26.175972, step: 988, phase: "warmup", keystream: 0},
                {x: 5.766730, y: 4.477089, z: 25.739085, step: 989, phase: "warmup", keystream: 0},
                {x: 5.637766, y: 4.562699, z: 25.310891, step: 990, phase: "warmup", keystream: 0},
                {x: 5.530259, y: 4.668677, z: 24.893168, step: 991, phase: "warmup", keystream: 0},
                {x: 5.444101, y: 4.793806, z: 24.487540, step: 992, phase: "warmup", keystream: 0},
                {x: 5.379072, y: 4.937090, z: 24.095519, step: 993, phase: "warmup", keystream: 0},
                {x: 5.334873, y: 5.097744, z: 23.718541, step: 994, phase: "warmup", keystream: 0},
                {x: 5.311161, y: 5.275177, z: 23.358005, step: 995, phase: "warmup", keystream: 0},
                {x: 5.307562, y: 5.468969, z: 23.015298, step: 996, phase: "warmup", keystream: 0},
                {x: 5.323703, y: 5.678845, z: 22.691826, step: 997, phase: "warmup", keystream: 0},
                {x: 5.359217, y: 5.904648, z: 22.389035, step: 998, phase: "warmup", keystream: 0},
                {x: 5.413760, y: 6.146306, z: 22.108437, step: 999, phase: "warmup", keystream: 0},
                {x: 5.487015, y: 6.403798, z: 21.851625, step: 1000, phase: "encryption", keystream: 74},
                {x: 5.578693, y: 6.677122, z: 21.620293, step: 1001, phase: "encryption", keystream: 65},
                {x: 5.688536, y: 6.966255, z: 21.416248, step: 1002, phase: "encryption", keystream: 34},
                {x: 5.816308, y: 7.271112, z: 21.241426, step: 1003, phase: "encryption", keystream: 109},
                {x: 5.961788, y: 7.591500, z: 21.097898, step: 1004, phase: "encryption", keystream: 170},
                {x: 6.124759, y: 7.927074, z: 20.987876, step: 1005, phase: "encryption", keystream: 169},
                {x: 6.304991, y: 8.277279, z: 20.913714, step: 1006, phase: "encryption", keystream: 190},
                {x: 6.502220, y: 8.641296, z: 20.877896, step: 1007, phase: "encryption", keystream: 86},
                {x: 6.716127, y: 9.017977, z: 20.883029, step: 1008, phase: "encryption", keystream: 47},
                {x: 6.946312, y: 9.405783, z: 20.931807, step: 1009, phase: "encryption", keystream: 82},
                {x: 7.192259, y: 9.802704, z: 21.026980, step: 1010, phase: "encryption", keystream: 94},
                {x: 7.453304, y: 10.206194, z: 21.171297, step: 1011, phase: "encryption", keystream: 118},
                {x: 7.728593, y: 10.613096, z: 21.367427, step: 1012, phase: "encryption", keystream: 120},
                {x: 8.017043, y: 11.019570, z: 21.617872, step: 1013, phase: "encryption", keystream: 76},
                {x: 8.317296, y: 11.421032, z: 21.924839, step: 1014, phase: "encryption", keystream: 180},
                {x: 8.627669, y: 11.812111, z: 22.290098, step: 1015, phase: "encryption", keystream: 57},
                {x: 8.946114, y: 12.186621, z: 22.714805, step: 1016, phase: "encryption", keystream: 69},
                {x: 9.270164, y: 12.537574, z: 23.199306, step: 1017, phase: "encryption", keystream: 125},
                {x: 9.596905, y: 12.857231, z: 23.742912, step: 1018, phase: "encryption", keystream: 136},
                {x: 9.922938, y: 13.137207, z: 24.343664, step: 1019, phase: "encryption", keystream: 132},
                {x: 10.244365, y: 13.368651, z: 24.998096, step: 1020, phase: "encryption", keystream: 208},
                {x: 10.556793, y: 13.542491, z: 25.701014, step: 1021, phase: "encryption", keystream: 146},
                {x: 10.855363, y: 13.649765, z: 26.445306, step: 1022, phase: "encryption", keystream: 5},
                {x: 11.134803, y: 13.682035, z: 27.221829, step: 1023, phase: "encryption", keystream: 48},
                {x: 11.389527, y: 13.631863, z: 28.019382, step: 1024, phase: "encryption", keystream: 216},
                {x: 11.613760, y: 13.493336, z: 28.824803, step: 1025, phase: "encryption", keystream: 212},
                {x: 11.801718, y: 13.262612, z: 29.623225, step: 1026, phase: "encryption", keystream: 132},
                {x: 11.947807, y: 12.938418, z: 30.398489, step: 1027, phase: "encryption", keystream: 10},
                {x: 12.046868, y: 12.522467, z: 31.133719, step: 1028, phase: "encryption", keystream: 11}
            ]
        };
        
        console.log("DATA LOADED:", chaosData.trajectory.length, "points");
        console.log("Encrypted text:", chaosData.metadata.plaintext);
        
        // ===== THREE.JS VISUALIZATION CORREGIDA =====
        class CorrectedChaosVisualizer {
            constructor() {
                this.scene = new THREE.Scene();
                this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                
                this.trajectory = chaosData.trajectory;
                this.currentPoint = 0;
                this.animationId = null;
                this.isPlaying = true;
                this.speed = 1.0;  // Velocidad como float
                this.accumulator = 0.0;  // Acumulador para velocidad fraccional
                this.trailLength = 500;
                this.loop = false;
                
                this.init();
            }
            
            init() {
                // Setup renderer
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setClearColor(0x0f0f23, 1);
                document.getElementById('canvas-container').appendChild(this.renderer.domElement);
                
                // Setup camera
                this.camera.position.set(0, 0, 50);
                
                // Controls
                this.controls = new THREE.OrbitControls(this.camera, this.renderer.domElement);
                this.controls.enableDamping = true;
                this.controls.dampingFactor = 0.05;
                
                // Lighting
                const ambientLight = new THREE.AmbientLight(0x404040);
                this.scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
                directionalLight.position.set(50, 50, 50);
                this.scene.add(directionalLight);
                
                // Attractor trail
                this.trailGeometry = new THREE.BufferGeometry();
                this.trailMaterial = new THREE.LineBasicMaterial({ 
                    color: 0x00ff00,
                    transparent: true,
                    opacity: 0.8
                });
                this.trail = new THREE.Line(this.trailGeometry, this.trailMaterial);
                this.scene.add(this.trail);
                
                // Current position marker
                const markerGeometry = new THREE.SphereGeometry(0.5, 16, 16);
                const markerMaterial = new THREE.MeshBasicMaterial({ color: 0xff4444 });
                this.marker = new THREE.Mesh(markerGeometry, markerMaterial);
                this.scene.add(this.marker);
                
                // Axes helper
                const axesHelper = new THREE.AxesHelper(20);
                this.scene.add(axesHelper);
                
                // Event listeners
                this.setupControls();
                this.animate();
                
                // Mostrar puntos totales
                document.getElementById('points-total').textContent = this.trajectory.length;
            }
            
            setupControls() {
                // Control de velocidad MEJORADO
                document.getElementById('speed').addEventListener('input', (e) => {
                    this.speed = parseFloat(e.target.value);
                    document.getElementById('speed-value').textContent = this.speed.toFixed(1) + 'x';
                });
                
                document.getElementById('trail').addEventListener('input', (e) => {
                    this.trailLength = parseInt(e.target.value);
                    document.getElementById('trail-value').textContent = this.trailLength;
                    this.updateTrail();
                });
                
                document.getElementById('play-pause').addEventListener('click', () => {
                    this.isPlaying = !this.isPlaying;
                    document.getElementById('play-pause').textContent = 
                        this.isPlaying ? 'â¸ï¸ Pause' : 'â–¶ï¸ Play';
                });
                
                document.getElementById('restart').addEventListener('click', () => {
                    this.currentPoint = 0;
                    this.accumulator = 0.0;
                    this.updateTrail();
                    this.isPlaying = true;
                    document.getElementById('play-pause').textContent = 'â¸ï¸ Pause';
                });
                
                document.getElementById('loop').addEventListener('click', () => {
                    this.loop = !this.loop;
                    document.getElementById('loop').textContent = 
                        this.loop ? 'ğŸ” Loop: ON' : 'ğŸ” Loop: OFF';
                });
                
                // Camera presets
                document.querySelectorAll('[data-preset]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const preset = e.target.dataset.preset;
                        this.setCameraPreset(preset);
                    });
                });
            }
            
            setCameraPreset(preset) {
                switch(preset) {
                    case 'top':
                        this.camera.position.set(0, 50, 0);
                        this.controls.target.set(0, 0, 0);
                        break;
                    case 'side':
                        this.camera.position.set(50, 0, 0);
                        this.controls.target.set(0, 0, 0);
                        break;
                    case 'orbit':
                        this.camera.position.set(30, 30, 30);
                        this.controls.target.set(0, 0, 0);
                        break;
                }
                this.controls.update();
            }
            
            updateTrail() {
                if (!this.trajectory || this.trajectory.length === 0) return;
                
                const start = Math.max(0, this.currentPoint - this.trailLength);
                const end = this.currentPoint + 1;  // Incluir punto actual
                const segment = this.trajectory.slice(start, end);
                
                const positions = new Float32Array(segment.length * 3);
                segment.forEach((point, i) => {
                    positions[i * 3] = point.x;
                    positions[i * 3 + 1] = point.y;
                    positions[i * 3 + 2] = point.z;
                });
                
                this.trailGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                this.trailGeometry.attributes.position.needsUpdate = true;
                
                // Update marker position
                const current = this.trajectory[Math.floor(this.currentPoint)];
                if (current) {
                    this.marker.position.set(current.x, current.y, current.z);
                    
                    // Update info panel
                    document.getElementById('step-info').children[0].textContent = current.step;
                    document.getElementById('phase-info').children[0].textContent = current.phase.toUpperCase();
                    document.getElementById('phase-info').children[0].className = `phase-${current.phase}`;
                    document.getElementById('pos-x').textContent = current.x.toFixed(3);
                    document.getElementById('pos-y').textContent = current.y.toFixed(3);
                    document.getElementById('pos-z').textContent = current.z.toFixed(3);
                    document.getElementById('keystream-info').children[0].textContent = current.keystream;
                    document.getElementById('points-current').textContent = Math.floor(this.currentPoint + 1);
                }
            }
            
            animate() {
                this.animationId = requestAnimationFrame(() => this.animate());
                
                if (this.isPlaying && this.trajectory && this.trajectory.length > 0) {
                    // Velocidad con acumulador para valores fraccionales
                    this.accumulator += this.speed;
                    
                    if (this.accumulator >= 1.0) {
                        const steps = Math.floor(this.accumulator);
                        this.accumulator -= steps;
                        this.currentPoint += steps;
                    }
                    
                    if (this.currentPoint >= this.trajectory.length) {
                        if (this.loop) {
                            this.currentPoint = 0;
                            this.accumulator = 0.0;
                        } else {
                            this.currentPoint = this.trajectory.length - 1;
                            this.isPlaying = false;
                            document.getElementById('play-pause').textContent = 'â–¶ï¸ Play';
                        }
                    }
                    
                    this.updateTrail();
                }
                
                this.controls.update();
                this.renderer.render(this.scene, this.camera);
                
                // Update FPS counter
                this.updateFPS();
            }
            
            updateFPS() {
                if (!this.lastTime) {
                    this.lastTime = performance.now();
                    this.frameCount = 0;
                    return;
                }
                
                this.frameCount++;
                const currentTime = performance.now();
                if (currentTime >= this.lastTime + 1000) {
                    document.getElementById('stats').children[1].textContent = 
                        Math.round((this.frameCount * 1000) / (currentTime - this.lastTime));
                    this.frameCount = 0;
                    this.lastTime = currentTime;
                }
            }
        }
        
        // Initialize when page loads
        window.addEventListener('load', () => {
            new CorrectedChaosVisualizer();
        });
        
        // Handle window resize
        window.addEventListener('resize', () => {
            if (window.visualizer) {
                window.visualizer.camera.aspect = window.innerWidth / window.innerHeight;
                window.visualizer.camera.updateProjectionMatrix();
                window.visualizer.renderer.setSize(window.innerWidth, window.innerHeight);
            }
        });
    </script>
</body>
</html>
